!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("rxjs/operators"),require("rxjs")):"function"==typeof define&&define.amd?define(["rxjs/operators","rxjs"],e):"object"==typeof exports?exports.rxidb=e(require("rxjs/operators"),require("rxjs")):t.rxidb=e(t["rxjs/operators"],t.rxjs)}(window,function(t,e){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(e,r){e.exports=t},function(t,r){t.exports=e},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(6),u=function(){function t(t,e){this.name=t,this._db=e,this._update$=new n.Subject,this.update$=this._update$.asObservable(),this._dataUpdate$=new n.Subject,this.data$=n.merge(this.getAll(),this._dataUpdate$).pipe(o.shareReplay(1))}return t.prototype.clear=function(){var t=this;return this.tx("readwrite").pipe(o.map(function(e){return e.objectStore(t.name)}),o.map(function(t){return t.clear()}),o.switchMap(function(t){return i.rxifyRequest(t)}),o.switchMap(function(e){return t._refreshDataStream().pipe(o.mapTo(e))}),o.take(1),o.mapTo(void 0))},t.prototype.cursor=function(t,e,r){var n=this;return void 0===t&&(t="readonly"),this.tx(t).pipe(o.map(function(t){return t.objectStore(n.name)}),o.map(function(t){return t.openCursor(e,r)}),o.switchMap(function(t){return i.rxifyRequest(t)}),i.resultFromIDBEvent)},t.prototype.delete=function(t){var e=this;return this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(e.name)}),o.map(function(e){return e.delete(t)}),o.switchMap(function(t){return i.rxifyRequest(t)}),o.switchMap(function(t){return e._refreshDataStream().pipe(o.mapTo(t))}),o.take(1),o.mapTo(void 0))},t.prototype.reset=function(t){var e=this;return this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(e.name)}),o.switchMap(function(t){return i.rxifyRequest(t.clear()).pipe(o.take(1),o.mapTo(t))}),o.map(function(e){return t.map(function(t){return i.rxifyRequest(e.put(t)).pipe(o.take(1),i.resultFromIDBEvent)})}),o.switchMap(function(t){return n.forkJoin(t)}),o.switchMap(function(t){return e._refreshDataStream().pipe(o.mapTo(t))}),o.take(1))},t.prototype.get=function(t){var e=this;return this.tx().pipe(o.map(function(t){return t.objectStore(e.name)}),o.map(function(e){return e.get(t)}),o.switchMap(function(t){return i.rxifyRequest(t)}),i.resultFromIDBEvent)},t.prototype.getAll=function(){var t=this.cursor(),e=new n.Subject;return t.pipe(o.tap(function(t){return t?t.continue():e.next()}),o.filter(function(t){return!!t}),o.map(function(t){return t.value}),o.bufferWhen(function(){return e}),o.take(1))},t.prototype.set=function(t,e){var r=this;return this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(r.name)}),o.map(function(r){return r.put(t,e)}),o.switchMap(function(t){return i.rxifyRequest(t)}),i.resultFromIDBEvent,o.switchMap(function(t){return r._refreshDataStream().pipe(o.mapTo(t))}))},t.prototype.tx=function(t){return void 0===t&&(t="readonly"),this._db.tx(this.name,t)},t.prototype._refreshDataStream=function(){var t=this;return this.getAll().pipe(o.tap(function(e){return t._dataUpdate$.next(e)}))},t}();e.RxIDBStore=u},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o._store=n,o}return o(e,t),e.prototype.createIndex=function(t,e,r){return this._store.createIndex(t,e,r)},e.prototype.fill=function(t){var e=this;return Array.from(t).forEach(function(t){return e._store.put(t)}),this},e}(r(2).RxIDBStore);e.RxIDBUpgradeStore=i;var u=function(){function t(t,e){this._rxidb=t,this.db=e.target.result,this.oldVersion=e.oldVersion,this.version=e.newVersion}return t.prototype.create=function(t,e){var r=this.db.createObjectStore(t,e);return new i(t,this._rxidb,r)},t.prototype.delete=function(t){this.db.deleteObjectStore(t)},t.prototype.has=function(t){return this.db.objectStoreNames.contains(t)},t}();e.RxIDBUpgrade=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),u=function(){function t(t){this.idb=t,this._storeCache={}}return t.prototype.close=function(){this.idb.close()},t.prototype.get=function(t){return this._storeCache[t]?this._storeCache[t]:this._storeCache[t]=new i.RxIDBStore(t,this)},t.prototype.tx=function(t,e){var r=this;return void 0===e&&(e="readonly"),n.of(null).pipe(o.map(function(){return r.idb.transaction(t,e)}))},t.prototype.transaction=function(t,e){return void 0===e&&(e="readonly"),this.idb.transaction(t,e)},t}();e.RxIDB=u},function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)u.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return u};Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),u=r(0),a=r(4),c=r(3);function p(t,e,r){var n,o=new i.Subject,p=new i.Subject,f=indexedDB.open(t,e);return f.onerror=function(t){return o.error(t)},f.onblocked=function(t){return o.error(t)},f.onsuccess=function(t){n=n||new a.RxIDB(t.target.result),o.next(n),o.complete(),e===n.idb.version&&(p.next(),p.complete())},f.onupgradeneeded=function(t){n=n||new a.RxIDB(t.target.result),s(new c.RxIDBUpgrade(n,t),r).subscribe(function(){return p.next()},function(t){return p.error(t)},function(){return p.complete()})},i.forkJoin([o,p]).pipe(u.map(function(){return n}))}function s(t,e){return e&&e.length?i.forkJoin(e.map(function(e){return f(t,e)})):i.of(null)}function f(t,e){var r,u;void 0===e&&(e=new Map);var a=t.oldVersion,c=[i.of(!0)];try{for(var p=n(e),s=p.next();!s.done;s=p.next()){var f=o(s.value,2),l=f[0],d=f[1];if(a<l){var h=d(t);h instanceof i.Observable&&c.push(h)}}}catch(t){r={error:t}}finally{try{s&&!s.done&&(u=p.return)&&u.call(p)}finally{if(r)throw r.error}}return c}function l(t){return i.Observable.create(function(e){var r=indexedDB.deleteDatabase(t);r.onblocked=function(t){return e.error(t)},r.onsuccess=function(){return e.next(void 0)},r.onerror=function(t){return e.error(t)}}).pipe(u.take(1))}e.openDB=p,e.onUpgradeEnded=s,e.setupLayers=f,e.dropDB=l,e.rxidb={openDB:p,dropDB:l}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r(0);e.rxifyRequest=function(t){var e=new n.Subject;return t.onerror=function(t){return e.error(t)},t.onsuccess=function(t){return e.next(t)},e},e.resultFromIDBEvent=function(t){return t.pipe(o.map(function(t){return t.target.result}))}},function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(4)),n(r(2)),n(r(3));var o=r(5);e.openDB=o.openDB,e.dropDB=o.dropDB}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yeGlkYi93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vcnhpZGIvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcnhpZGIvZXh0ZXJuYWwgXCJyeGpzL29wZXJhdG9yc1wiIiwid2VicGFjazovL3J4aWRiL2V4dGVybmFsIFwicnhqc1wiIiwid2VicGFjazovL3J4aWRiLy4vc3JjL3J4aWRiLXN0b3JlLnRzIiwid2VicGFjazovL3J4aWRiLy4vc3JjL3J4aWRiLXVwZ3JhZGUudHMiLCJ3ZWJwYWNrOi8vcnhpZGIvLi9zcmMvcnhpZGItZGIudHMiLCJ3ZWJwYWNrOi8vcnhpZGIvLi9zcmMvcnhpZGItc3RhdGljLnRzIiwid2VicGFjazovL3J4aWRiLy4vc3JjL3J4aWRiLXV0aWxzLnRzIiwid2VicGFjazovL3J4aWRiLy4vcnhpZGIudHMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwicmVxdWlyZSIsImRlZmluZSIsImFtZCIsIndpbmRvdyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzBfXyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzFfXyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJyeGpzXzEiLCJvcGVyYXRvcnNfMSIsInJ4aWRiX3V0aWxzXzEiLCJSeElEQlN0b3JlIiwiX2RiIiwidGhpcyIsIl91cGRhdGUkIiwiU3ViamVjdCIsInVwZGF0ZSQiLCJhc09ic2VydmFibGUiLCJfZGF0YVVwZGF0ZSQiLCJkYXRhJCIsIm1lcmdlIiwiZ2V0QWxsIiwicGlwZSIsInNoYXJlUmVwbGF5IiwiY2xlYXIiLCJfdGhpcyIsInR4IiwibWFwIiwib2JqZWN0U3RvcmUiLCJzdG9yZSIsInN3aXRjaE1hcCIsInJlcSIsInJ4aWZ5UmVxdWVzdCIsInJlc3VsdCIsIl9yZWZyZXNoRGF0YVN0cmVhbSIsIm1hcFRvIiwidGFrZSIsInVuZGVmaW5lZCIsImN1cnNvciIsInJhbmdlIiwiZGlyZWN0aW9uIiwib3BlbkN1cnNvciIsInJlc3VsdEZyb21JREJFdmVudCIsImRlbGV0ZSIsInJlc2V0IiwiY29sbGVjdGlvbiIsInB1dCIsInRhc2tzIiwiZm9ya0pvaW4iLCJjdXJzb3IkIiwiZG9uZSQiLCJ0YXAiLCJjb250aW51ZSIsIm5leHQiLCJmaWx0ZXIiLCJidWZmZXJXaGVuIiwic2V0IiwiZGF0YSIsIlJ4SURCVXBncmFkZVN0b3JlIiwiX3N1cGVyIiwiX25hbWUiLCJfcnhpZGIiLCJfc3RvcmUiLCJfX2V4dGVuZHMiLCJjcmVhdGVJbmRleCIsImtleXBhdGgiLCJwYXJhbXMiLCJmaWxsIiwiZW50cmllcyIsIkFycmF5IiwiZnJvbSIsImZvckVhY2giLCJlbnRyeSIsIlJ4SURCVXBncmFkZSIsIl9ldmVudCIsImRiIiwidGFyZ2V0Iiwib2xkVmVyc2lvbiIsInZlcnNpb24iLCJuZXdWZXJzaW9uIiwib3B0aW9ucyIsImNyZWF0ZU9iamVjdFN0b3JlIiwiZGVsZXRlT2JqZWN0U3RvcmUiLCJoYXMiLCJvYmplY3RTdG9yZU5hbWVzIiwiY29udGFpbnMiLCJyeGlkYl9zdG9yZV8xIiwiUnhJREIiLCJpZGIiLCJfc3RvcmVDYWNoZSIsImNsb3NlIiwib2YiLCJ0cmFuc2FjdGlvbiIsInJ4aWRiX2RiXzEiLCJyeGlkYl91cGdyYWRlXzEiLCJvcGVuREIiLCJkYk5hbWUiLCJkYlZlcnNpb24iLCJzdG9yZXMiLCJyeElEQiIsImRiJCIsInVwZ3JhZGUkIiwicmVxdWVzdCIsImluZGV4ZWREQiIsIm9wZW4iLCJvbmVycm9yIiwiZSIsImVycm9yIiwib25ibG9ja2VkIiwib25zdWNjZXNzIiwiZXZlbnQiLCJjb21wbGV0ZSIsIm9udXBncmFkZW5lZWRlZCIsIm9uVXBncmFkZUVuZGVkIiwic3Vic2NyaWJlIiwicnhJREJVcGdyYWRlIiwibGVuZ3RoIiwibGF5ZXJzIiwic2V0dXBMYXllcnMiLCJNYXAiLCJvYnNlcnZhYmxlcyIsImxheWVyc18xIiwiX192YWx1ZXMiLCJsYXllcnNfMV8xIiwiZG9uZSIsIl9iIiwiX19yZWFkIiwibGF5ZXJWZXJzaW9uIiwibGF5ZXJJbnN0YWxsZXIiLCJPYnNlcnZhYmxlIiwicHVzaCIsImRyb3BEQiIsIm9ic2VydmVyIiwiZGVsZXRlRGF0YWJhc2UiLCJyeGlkYiIsInJlcXVlc3QkIiwic291cmNlIiwiX19leHBvcnQiLCJyeGlkYl9zdGF0aWNfMSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxpQkFBQUMsU0FBQSxpQkFBQUMsT0FDQUEsT0FBQUQsUUFBQUQsRUFBQUcsUUFBQSxrQkFBQUEsUUFBQSxTQUNBLG1CQUFBQyxlQUFBQyxJQUNBRCxRQUFBLHlCQUFBSixHQUNBLGlCQUFBQyxRQUNBQSxRQUFBLE1BQUFELEVBQUFHLFFBQUEsa0JBQUFBLFFBQUEsU0FFQUosRUFBQSxNQUFBQyxFQUFBRCxFQUFBLGtCQUFBQSxFQUFBLE1BUkEsQ0FTQ08sT0FBQSxTQUFBQyxFQUFBQyxHQUNELG1CQ1RBLElBQUFDLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFWLFFBR0EsSUFBQUMsRUFBQU8sRUFBQUUsSUFDQUMsRUFBQUQsRUFDQUUsR0FBQSxFQUNBWixZQVVBLE9BTkFhLEVBQUFILEdBQUFJLEtBQUFiLEVBQUFELFFBQUFDLElBQUFELFFBQUFTLEdBR0FSLEVBQUFXLEdB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bkssRUFBQSxJQUNBbUssRUFBQW5LLEVBQUEsSUFDQW1LLEVBQUFuSyxFQUFBLElBQ0EsSUFBQW9LLEVBQUFwSyxFQUFBLEdBQVNULEVBQUFrSSxPQUFBMkMsRUFBQTNDLE9BQVFsSSxFQUFBc0ssT0FBQU8sRUFBQVAiLCJmaWxlIjoicnhpZGIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJyeGpzL29wZXJhdG9yc1wiKSwgcmVxdWlyZShcInJ4anNcIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW1wicnhqcy9vcGVyYXRvcnNcIiwgXCJyeGpzXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInJ4aWRiXCJdID0gZmFjdG9yeShyZXF1aXJlKFwicnhqcy9vcGVyYXRvcnNcIiksIHJlcXVpcmUoXCJyeGpzXCIpKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJyeGlkYlwiXSA9IGZhY3Rvcnkocm9vdFtcInJ4anMvb3BlcmF0b3JzXCJdLCByb290W1wicnhqc1wiXSk7XG59KSh3aW5kb3csIGZ1bmN0aW9uKF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzBfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMV9fKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDcpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18wX187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xX187IiwiaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCwgbWVyZ2UsIGZvcmtKb2luIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAsIHN3aXRjaE1hcCwgbWFwVG8sIHRhcCwgZmlsdGVyLCBidWZmZXJXaGVuLCBzaGFyZVJlcGxheSwgdGFrZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgUnhJREIgfSBmcm9tICcuL3J4aWRiLWRiJztcbmltcG9ydCB7IElSeElEQlN0b3JlIH0gZnJvbSAnLi9yeGlkYi5pbnRlcmZhY2VzJztcbmltcG9ydCB7IHJ4aWZ5UmVxdWVzdCwgcmVzdWx0RnJvbUlEQkV2ZW50IH0gZnJvbSAnLi9yeGlkYi11dGlscyc7XG5cbmV4cG9ydCB0eXBlIFJ4SURCQ3Vyc29yUmFuZ2UgPSBzdHJpbmcgfCBudW1iZXIgfCBJREJLZXlSYW5nZSB8IERhdGUgfCBJREJBcnJheUtleSB8IHVuZGVmaW5lZDtcblxuZXhwb3J0IGNsYXNzIFJ4SURCU3RvcmU8TW9kZWwgPSBhbnk+IGltcGxlbWVudHMgSVJ4SURCU3RvcmUge1xuICBwcml2YXRlIF91cGRhdGUkOiBTdWJqZWN0PHZvaWQ+ID0gbmV3IFN1YmplY3QoKTtcbiAgcHVibGljIHVwZGF0ZSQ6IE9ic2VydmFibGU8YW55PiA9IHRoaXMuX3VwZGF0ZSQuYXNPYnNlcnZhYmxlKCk7XG5cbiAgcHJpdmF0ZSBfZGF0YVVwZGF0ZSQ6IFN1YmplY3Q8TW9kZWxbXT4gPSBuZXcgU3ViamVjdCgpO1xuICBwdWJsaWMgZGF0YSQ6IE9ic2VydmFibGU8TW9kZWxbXT4gPSBtZXJnZShcbiAgICB0aGlzLmdldEFsbCgpLFxuICAgIHRoaXMuX2RhdGFVcGRhdGUkXG4gICkucGlwZShcbiAgICBzaGFyZVJlcGxheSgxKVxuICApO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSBfZGI6IFJ4SURCXG4gICkge31cblxuICBwdWJsaWMgY2xlYXIoKTogT2JzZXJ2YWJsZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMudHgoJ3JlYWR3cml0ZScpLnBpcGUoXG4gICAgICBtYXAoKHR4KSA9PiB0eC5vYmplY3RTdG9yZSh0aGlzLm5hbWUpKSxcbiAgICAgIG1hcCgoc3RvcmUpID0+IHN0b3JlLmNsZWFyKCkpLFxuICAgICAgc3dpdGNoTWFwKHJlcSA9PiByeGlmeVJlcXVlc3QocmVxKSksXG4gICAgICBzd2l0Y2hNYXAocmVzdWx0ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlZnJlc2hEYXRhU3RyZWFtKCkucGlwZShcbiAgICAgICAgICBtYXBUbyhyZXN1bHQpXG4gICAgICAgICk7XG4gICAgICB9KSxcbiAgICAgIHRha2UoMSksXG4gICAgICBtYXBUbyh1bmRlZmluZWQpXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBjdXJzb3IoXG4gICAgbW9kZTogJ3JlYWRvbmx5J3wncmVhZHdyaXRlJyA9ICdyZWFkb25seScsXG4gICAgcmFuZ2U/OiBSeElEQkN1cnNvclJhbmdlLFxuICAgIGRpcmVjdGlvbj86IElEQkN1cnNvckRpcmVjdGlvblxuICApOiBPYnNlcnZhYmxlPElEQkN1cnNvcldpdGhWYWx1ZT4ge1xuICAgIHJldHVybiB0aGlzLnR4KG1vZGUpLnBpcGUoXG4gICAgICBtYXAodHggPT4gdHgub2JqZWN0U3RvcmUodGhpcy5uYW1lKSksXG4gICAgICBtYXAoc3RvcmUgPT4gc3RvcmUub3BlbkN1cnNvcihyYW5nZSwgZGlyZWN0aW9uKSksXG4gICAgICBzd2l0Y2hNYXAocmVxID0+IHJ4aWZ5UmVxdWVzdChyZXEpKSxcbiAgICAgIHJlc3VsdEZyb21JREJFdmVudFxuICAgICk7XG4gIH1cblxuICBwdWJsaWMgZGVsZXRlKGtleTogSURCVmFsaWRLZXkpOiBPYnNlcnZhYmxlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy50eCgncmVhZHdyaXRlJykucGlwZShcbiAgICAgIG1hcCgodHgpID0+IHR4Lm9iamVjdFN0b3JlKHRoaXMubmFtZSkpLFxuICAgICAgbWFwKChzdG9yZSkgPT4gc3RvcmUuZGVsZXRlKGtleSkpLFxuICAgICAgc3dpdGNoTWFwKHJlcSA9PiByeGlmeVJlcXVlc3QocmVxKSksXG4gICAgICBzd2l0Y2hNYXAocmVzdWx0ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlZnJlc2hEYXRhU3RyZWFtKCkucGlwZShcbiAgICAgICAgICBtYXBUbyhyZXN1bHQpXG4gICAgICAgICk7XG4gICAgICB9KSxcbiAgICAgIHRha2UoMSksXG4gICAgICBtYXBUbyh1bmRlZmluZWQpXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyByZXNldChjb2xsZWN0aW9uOiBhbnlbXSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMudHgoJ3JlYWR3cml0ZScpLnBpcGUoXG4gICAgICBtYXAoKHR4KSA9PiB0eC5vYmplY3RTdG9yZSh0aGlzLm5hbWUpKSxcbiAgICAgIHN3aXRjaE1hcChzdG9yZSA9PiByeGlmeVJlcXVlc3Qoc3RvcmUuY2xlYXIoKSkucGlwZSh0YWtlKDEpLCBtYXBUbyhzdG9yZSkpKSxcbiAgICAgIG1hcChzdG9yZSA9PiB7XG4gICAgICAgIHJldHVybiBjb2xsZWN0aW9uLm1hcCh2YWx1ZSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHJ4aWZ5UmVxdWVzdChzdG9yZS5wdXQodmFsdWUpKS5waXBlKFxuICAgICAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgICAgIHJlc3VsdEZyb21JREJFdmVudFxuICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuICAgICAgfSksXG4gICAgICBzd2l0Y2hNYXAoKHRhc2tzOiBPYnNlcnZhYmxlPGFueT5bXSkgPT4gZm9ya0pvaW4odGFza3MpKSxcbiAgICAgIHN3aXRjaE1hcChyZXN1bHQgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVmcmVzaERhdGFTdHJlYW0oKS5waXBlKFxuICAgICAgICAgIG1hcFRvKHJlc3VsdClcbiAgICAgICAgKTtcbiAgICAgIH0pLFxuICAgICAgdGFrZSgxKVxuICAgICk7XG4gIH1cblxuICBwdWJsaWMgZ2V0KGtleTogSURCVmFsaWRLZXkpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLnR4KCkucGlwZShcbiAgICAgIG1hcCgodHgpID0+IHR4Lm9iamVjdFN0b3JlKHRoaXMubmFtZSkpLFxuICAgICAgbWFwKHN0b3JlID0+IHN0b3JlLmdldChrZXkpKSxcbiAgICAgIHN3aXRjaE1hcChyZXEgPT4gcnhpZnlSZXF1ZXN0KHJlcSkpLFxuICAgICAgcmVzdWx0RnJvbUlEQkV2ZW50XG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRBbGwoKTogT2JzZXJ2YWJsZTxNb2RlbFtdPiB7XG4gICAgbGV0IGN1cnNvciQgPSB0aGlzLmN1cnNvcigpO1xuICAgIGxldCBkb25lJCAgID0gbmV3IFN1YmplY3QoKTtcblxuICAgIHJldHVybiBjdXJzb3IkLnBpcGUoXG4gICAgICB0YXAoY3Vyc29yID0+ICEhY3Vyc29yID8gY3Vyc29yLmNvbnRpbnVlKCkgOiBkb25lJC5uZXh0KCkpLFxuICAgICAgZmlsdGVyKGN1cnNvciA9PiAhIWN1cnNvciksXG4gICAgICBtYXAoY3Vyc29yID0+IGN1cnNvci52YWx1ZSksXG4gICAgICBidWZmZXJXaGVuKCgpID0+IGRvbmUkKSxcbiAgICAgIHRha2UoMSlcbiAgICApO1xuICB9XG5cbiAgcHVibGljIHNldCh2YWx1ZTogYW55LCBrZXk/OiBJREJWYWxpZEtleSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMudHgoJ3JlYWR3cml0ZScpLnBpcGUoXG4gICAgICBtYXAoKHR4KSA9PiB0eC5vYmplY3RTdG9yZSh0aGlzLm5hbWUpKSxcbiAgICAgIG1hcChzdG9yZSA9PiBzdG9yZS5wdXQodmFsdWUsIGtleSkpLFxuICAgICAgc3dpdGNoTWFwKHJlcSA9PiByeGlmeVJlcXVlc3QocmVxKSksXG4gICAgICByZXN1bHRGcm9tSURCRXZlbnQsXG4gICAgICBzd2l0Y2hNYXAocmVzdWx0ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlZnJlc2hEYXRhU3RyZWFtKCkucGlwZShcbiAgICAgICAgICBtYXBUbyhyZXN1bHQpXG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBwdWJsaWMgdHgobW9kZTogJ3JlYWRvbmx5JyB8ICdyZWFkd3JpdGUnID0gJ3JlYWRvbmx5Jyk6IE9ic2VydmFibGU8SURCVHJhbnNhY3Rpb24+IHtcbiAgICByZXR1cm4gdGhpcy5fZGIudHgodGhpcy5uYW1lLCBtb2RlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUcmlnZ2VyIHVwZGF0ZSBzdHJlYW1cbiAgICovXG4gIHByaXZhdGUgX3JlZnJlc2hEYXRhU3RyZWFtKCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QWxsKCkucGlwZShcbiAgICAgIHRhcChkYXRhID0+IHRoaXMuX2RhdGFVcGRhdGUkLm5leHQoZGF0YSkpXG4gICAgKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUnhJREIgfSBmcm9tICcuL3J4aWRiLWRiJztcbmltcG9ydCB7IFJ4SURCU3RvcmUgfSBmcm9tICcuL3J4aWRiLXN0b3JlJztcbmltcG9ydCB7IElSeElEQlVwZ3JhZGUgfSBmcm9tICcuL3J4aWRiLmludGVyZmFjZXMnO1xuXG5leHBvcnQgY2xhc3MgUnhJREJVcGdyYWRlU3RvcmUgZXh0ZW5kcyBSeElEQlN0b3JlIHtcbiAgY29uc3RydWN0b3IoXG4gICAgX25hbWU6IHN0cmluZyxcbiAgICBfcnhpZGI6IFJ4SURCLFxuICAgIHByaXZhdGUgX3N0b3JlOiBJREJPYmplY3RTdG9yZVxuICApIHtcbiAgICBzdXBlcihfbmFtZSwgX3J4aWRiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgaW5kZXhcbiAgICovXG4gIHB1YmxpYyBjcmVhdGVJbmRleChuYW1lOiBzdHJpbmcsIGtleXBhdGg6IHN0cmluZywgcGFyYW1zPzogSURCSW5kZXhQYXJhbWV0ZXJzKTogSURCSW5kZXgge1xuICAgIHJldHVybiB0aGlzLl9zdG9yZS5jcmVhdGVJbmRleChuYW1lLCBrZXlwYXRoLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbGwgREIgd2l0aCBlbnRyaWVzXG4gICAqL1xuICBwdWJsaWMgZmlsbChlbnRyaWVzOiBJdGVyYWJsZTxhbnk+KTogdGhpcyB7XG4gICAgQXJyYXkuZnJvbShlbnRyaWVzKS5mb3JFYWNoKGVudHJ5ID0+IHRoaXMuX3N0b3JlLnB1dChlbnRyeSkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSeElEQlVwZ3JhZGUgaW1wbGVtZW50cyBJUnhJREJVcGdyYWRlIHtcbiAgcHVibGljIHJlYWRvbmx5IGRiOiBJREJEYXRhYmFzZTtcbiAgcHVibGljIHJlYWRvbmx5IG9sZFZlcnNpb246IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IHZlcnNpb246IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvciAoXG4gICAgcHJpdmF0ZSBfcnhpZGI6IFJ4SURCLFxuICAgIF9ldmVudDogYW55XG4gICkge1xuICAgIHRoaXMuZGIgICAgICAgICA9IF9ldmVudC50YXJnZXQucmVzdWx0O1xuICAgIHRoaXMub2xkVmVyc2lvbiA9IF9ldmVudC5vbGRWZXJzaW9uO1xuICAgIHRoaXMudmVyc2lvbiAgICA9IF9ldmVudC5uZXdWZXJzaW9uO1xuICB9XG5cbiAgcHVibGljIGNyZWF0ZShuYW1lOiBzdHJpbmcsIG9wdGlvbnM/OiBJREJPYmplY3RTdG9yZVBhcmFtZXRlcnMpOiBSeElEQlVwZ3JhZGVTdG9yZSB7XG4gICAgbGV0IHN0b3JlID0gdGhpcy5kYi5jcmVhdGVPYmplY3RTdG9yZShuYW1lLCBvcHRpb25zKTtcbiAgICByZXR1cm4gbmV3IFJ4SURCVXBncmFkZVN0b3JlKG5hbWUsIHRoaXMuX3J4aWRiLCBzdG9yZSk7XG4gIH1cblxuICBwdWJsaWMgZGVsZXRlKG5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuZGIuZGVsZXRlT2JqZWN0U3RvcmUobmFtZSk7XG4gIH1cblxuICBwdWJsaWMgaGFzKG5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMobmFtZSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7IElSeElEQiB9IGZyb20gJy4vcnhpZGIuaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBSeElEQlN0b3JlIH0gZnJvbSAnLi9yeGlkYi1zdG9yZSc7XG5cbmV4cG9ydCBjbGFzcyBSeElEQiBpbXBsZW1lbnRzIElSeElEQiB7XG4gIHByaXZhdGUgX3N0b3JlQ2FjaGU6IHtba2V5OiBzdHJpbmddOiBSeElEQlN0b3JlfSA9IHt9O1xuXG4gIGNvbnN0cnVjdG9yIChcbiAgICBwdWJsaWMgcmVhZG9ubHkgaWRiOiBJREJEYXRhYmFzZVxuICApIHt9XG5cbiAgLyoqXG4gICAqIENsb3NlIGRiXG4gICAqL1xuICBwdWJsaWMgY2xvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5pZGIuY2xvc2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3RvcmVcbiAgICovXG4gIHB1YmxpYyBnZXQoa2V5OiBzdHJpbmcpOiBSeElEQlN0b3JlIHtcbiAgICBpZiAodGhpcy5fc3RvcmVDYWNoZVtrZXldKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcmVDYWNoZVtrZXldO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9zdG9yZUNhY2hlW2tleV0gPSBuZXcgUnhJREJTdG9yZShrZXksIHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0cmVhbTogSURCVHJhbnNhY3Rpb25cbiAgICovXG4gIHB1YmxpYyB0eChcbiAgICBzdG9yZTogc3RyaW5nIHwgc3RyaW5nW10sXG4gICAgbW9kZTogJ3JlYWRvbmx5JyB8ICdyZWFkd3JpdGUnID0gJ3JlYWRvbmx5J1xuICApOiBPYnNlcnZhYmxlPElEQlRyYW5zYWN0aW9uPiB7XG4gICAgcmV0dXJuIG9mKG51bGwpLnBpcGUoXG4gICAgICBtYXAoKCkgPT4gdGhpcy5pZGIudHJhbnNhY3Rpb24oc3RvcmUsIG1vZGUpKVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogT3BlbiBJREJUcmFuc2FjdGlvblxuICAgKi9cbiAgcHVibGljIHRyYW5zYWN0aW9uKFxuICAgIHN0b3JlOiBzdHJpbmd8c3RyaW5nW10sXG4gICAgbW9kZTogJ3JlYWRvbmx5J3wncmVhZHdyaXRlJyA9ICdyZWFkb25seSdcbiAgKTogSURCVHJhbnNhY3Rpb24ge1xuICAgIHJldHVybiB0aGlzLmlkYi50cmFuc2FjdGlvbihzdG9yZSwgbW9kZSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IE9ic2VydmFibGUsIGZvcmtKb2luLCBTdWJqZWN0LCBvZiwgT2JzZXJ2ZXIgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHRha2UsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgUnhJREIgfSBmcm9tICcuL3J4aWRiLWRiJztcbmltcG9ydCB7IFJ4SURCTGF5ZXJzIH0gZnJvbSAnLi9yeGlkYi50eXBlcyc7XG5pbXBvcnQgeyBSeElEQlVwZ3JhZGUgfSBmcm9tICcuL3J4aWRiLXVwZ3JhZGUnO1xuXG5leHBvcnQgZnVuY3Rpb24gb3BlbkRCKGRiTmFtZTogc3RyaW5nLCBkYlZlcnNpb246IG51bWJlciwgc3RvcmVzPzogUnhJREJMYXllcnNbXSk6IE9ic2VydmFibGU8UnhJREI+IHtcbiAgbGV0IGRiJDogU3ViamVjdDxSeElEQj4gPSBuZXcgU3ViamVjdCgpO1xuICBsZXQgdXBncmFkZSQ6IFN1YmplY3Q8dm9pZD4gPSBuZXcgU3ViamVjdCgpO1xuICBsZXQgcmVxdWVzdDogSURCT3BlbkRCUmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKGRiTmFtZSwgZGJWZXJzaW9uKTtcbiAgbGV0IHJ4SURCOiBSeElEQjtcblxuICByZXF1ZXN0Lm9uZXJyb3IgICAgICAgICA9IChlOiBhbnkpID0+IGRiJC5lcnJvcihlKTtcbiAgcmVxdWVzdC5vbmJsb2NrZWQgICAgICAgPSAoZTogYW55KSA9PiBkYiQuZXJyb3IoZSk7XG4gIHJlcXVlc3Qub25zdWNjZXNzICAgICAgID0gKGV2ZW50OiBhbnkpID0+IHtcbiAgICByeElEQiA9IHJ4SURCIHx8IG5ldyBSeElEQihldmVudC50YXJnZXQucmVzdWx0KTtcbiAgICBkYiQubmV4dChyeElEQik7XG4gICAgZGIkLmNvbXBsZXRlKCk7XG5cbiAgICBpZiAoZGJWZXJzaW9uID09PSByeElEQi5pZGIudmVyc2lvbikge1xuICAgICAgdXBncmFkZSQubmV4dCgpO1xuICAgICAgdXBncmFkZSQuY29tcGxldGUoKTtcbiAgICB9XG4gIH07XG4gIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gKGV2ZW50OiBhbnkpID0+IHtcbiAgICByeElEQiA9IHJ4SURCIHx8IG5ldyBSeElEQihldmVudC50YXJnZXQucmVzdWx0KTtcbiAgICBvblVwZ3JhZGVFbmRlZChuZXcgUnhJREJVcGdyYWRlKHJ4SURCLCBldmVudCksIHN0b3Jlcykuc3Vic2NyaWJlKFxuICAgICAgKCkgPT4gdXBncmFkZSQubmV4dCgpLFxuICAgICAgKGUpID0+IHVwZ3JhZGUkLmVycm9yKGUpLFxuICAgICAgKCkgPT4gdXBncmFkZSQuY29tcGxldGUoKVxuICAgICk7XG4gIH07XG5cbiAgcmV0dXJuIGZvcmtKb2luKFtkYiQsIHVwZ3JhZGUkXSkucGlwZShcbiAgICBtYXAoKCkgPT4gcnhJREIpXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBvblVwZ3JhZGVFbmRlZChyeElEQlVwZ3JhZGU6IFJ4SURCVXBncmFkZSwgc3RvcmVzPzogUnhJREJMYXllcnNbXSk6IE9ic2VydmFibGU8YW55PiB7XG4gIGlmICghc3RvcmVzIHx8ICFzdG9yZXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIG9mKG51bGwpO1xuICB9XG5cbiAgcmV0dXJuIGZvcmtKb2luKHN0b3Jlcy5tYXAobGF5ZXJzID0+IHNldHVwTGF5ZXJzKHJ4SURCVXBncmFkZSwgbGF5ZXJzKSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBMYXllcnMocnhJREJVcGdyYWRlOiBSeElEQlVwZ3JhZGUsIGxheWVyczogUnhJREJMYXllcnMgPSBuZXcgTWFwKCkpOiBPYnNlcnZhYmxlPGFueT5bXSB7XG4gIGxldCB7IG9sZFZlcnNpb24gfSA9IHJ4SURCVXBncmFkZTtcbiAgbGV0IG9ic2VydmFibGVzOiBPYnNlcnZhYmxlPGFueT5bXSA9IFtvZih0cnVlKV07XG5cbiAgZm9yIChjb25zdCBbbGF5ZXJWZXJzaW9uLCBsYXllckluc3RhbGxlcl0gb2YgbGF5ZXJzKSB7XG4gICAgaWYgKG9sZFZlcnNpb24gPCBsYXllclZlcnNpb24pIHtcbiAgICAgIGxldCByZXN1bHQgPSBsYXllckluc3RhbGxlcihyeElEQlVwZ3JhZGUpO1xuXG4gICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgT2JzZXJ2YWJsZSkge1xuICAgICAgICBvYnNlcnZhYmxlcy5wdXNoKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG9ic2VydmFibGVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZHJvcERCKGRiTmFtZTogc3RyaW5nKTogT2JzZXJ2YWJsZTx2b2lkPiB7XG4gIHJldHVybiBPYnNlcnZhYmxlLmNyZWF0ZSgob2JzZXJ2ZXI6IE9ic2VydmVyPHZvaWQ+KSA9PiB7XG4gICAgbGV0IHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoZGJOYW1lKTtcblxuICAgIHJlcXVlc3Qub25ibG9ja2VkID0gKGUpID0+IG9ic2VydmVyLmVycm9yKGUpO1xuICAgIHJlcXVlc3Qub25zdWNjZXNzID0gKCkgPT4gb2JzZXJ2ZXIubmV4dCh1bmRlZmluZWQpO1xuICAgIHJlcXVlc3Qub25lcnJvciA9IChlKSA9PiBvYnNlcnZlci5lcnJvcihlKTtcbiAgfSkucGlwZSh0YWtlKDEpKTtcbn1cblxuZXhwb3J0IGNvbnN0IHJ4aWRiID0geyBvcGVuREIsIGRyb3BEQiB9O1xuIiwiaW1wb3J0IHsgU3ViamVjdCwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG4vKipcbiAqIFJlc29sdmUgcmVxdWVzdCBhcyBhbiBPYnNlcnZhYmxlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByeGlmeVJlcXVlc3QocmVxdWVzdDogSURCUmVxdWVzdCk6IE9ic2VydmFibGU8YW55PiB7XG4gIGxldCByZXF1ZXN0JDogU3ViamVjdDxhbnk+ID0gbmV3IFN1YmplY3QoKTtcblxuICByZXF1ZXN0Lm9uZXJyb3IgICA9IChlOiBhbnkpID0+IHJlcXVlc3QkLmVycm9yKGUpO1xuICByZXF1ZXN0Lm9uc3VjY2VzcyA9IChlOiBhbnkpID0+IHJlcXVlc3QkLm5leHQoZSk7XG5cbiAgcmV0dXJuIHJlcXVlc3QkO1xufVxuXG4vKipcbiAqIFBpcGUgb3BlcmF0b3IgZm9yIGV4dHJhY3RpbmcgcmVzdWx0IGZyb20gaWRiIGV2ZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXN1bHRGcm9tSURCRXZlbnQoc291cmNlOiBPYnNlcnZhYmxlPGFueT4pIHtcbiAgcmV0dXJuIHNvdXJjZS5waXBlKFxuICAgIG1hcCgoZTogYW55KSA9PiBlLnRhcmdldC5yZXN1bHQpXG4gICk7XG59XG4iLCJleHBvcnQgKiBmcm9tICcuL3NyYy9yeGlkYi50eXBlcyc7XG5leHBvcnQgKiBmcm9tICcuL3NyYy9yeGlkYi1kYic7XG5leHBvcnQgKiBmcm9tICcuL3NyYy9yeGlkYi1zdG9yZSc7XG5leHBvcnQgKiBmcm9tICcuL3NyYy9yeGlkYi11cGdyYWRlJztcbmV4cG9ydCB7IG9wZW5EQiwgZHJvcERCIH0gZnJvbSAnLi9zcmMvcnhpZGItc3RhdGljJztcbiJdLCJzb3VyY2VSb290IjoiIn0=