!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define(["rxjs","rxjs/operators"],e):"object"==typeof exports?exports.rxidb=e(require("rxjs"),require("rxjs/operators")):t.rxidb=e(t.rxjs,t["rxjs/operators"])}(window,function(t,e){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=5)}([function(e,r){e.exports=t},function(t,r){t.exports=e},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),o=r(1),i=r(6),u=function(){function t(t,e){var r=this;this.name=t,this._db=e,this._dataUpdate$=new n.Subject,this._dataUpdateKey$=new n.Subject,this.keyPath$=this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(r.name)}),o.map(function(t){return t.keyPath})),this.data$=n.merge(this.getAll(),this._dataUpdate$).pipe(o.shareReplay(1)),this._dataTs$=new n.BehaviorSubject(-1),this.dataTs$=this._dataTs$.asObservable()}return t.prototype.clear=function(){var t=this;return this.tx("readwrite").pipe(o.map(function(e){return e.objectStore(t.name)}),o.map(function(t){return t.clear()}),o.switchMap(function(t){return i.rxifyRequest(t)}),o.switchMap(function(e){return t._refreshDataStream(e)}),o.take(1),o.mapTo(void 0))},t.prototype.cursor=function(t,e,r){var n=this;return void 0===t&&(t="readonly"),this.tx(t).pipe(o.map(function(t){return t.objectStore(n.name)}),o.map(function(t){return t.openCursor(e,r)}),o.switchMap(function(t){return i.rxifyRequest(t)}),i.resultFromIDBEvent)},t.prototype.delete=function(t){var e=this;return this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(e.name)}),o.map(function(e){return e.delete(t)}),o.switchMap(function(t){return i.rxifyRequest(t)}),o.switchMap(function(r){return e._refreshDataStream(r,t)}),o.take(1),o.mapTo(void 0))},t.prototype.reset=function(t){var e=this;return this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(e.name)}),o.switchMap(function(t){return i.rxifyRequest(t.clear()).pipe(o.take(1),o.mapTo(t))}),o.map(function(e){return t.map(function(t){return i.rxifyRequest(e.put(t)).pipe(o.take(1),i.resultFromIDBEvent)})}),o.switchMap(function(t){return n.forkJoin(t)}),o.switchMap(function(t){return e._refreshDataStream(t,"__each__")}),o.take(1))},t.prototype.get=function(t){var e=this;return n.merge(n.of(null),this._getUpdatesFor(t)).pipe(o.switchMap(function(){return e.tx()}),o.map(function(t){return t.objectStore(e.name)}),o.map(function(e){return e.get(t)}),o.switchMap(function(t){return i.rxifyRequest(t)}),i.resultFromIDBEvent)},t.prototype.getAll=function(){var t=this.cursor(),e=new n.Subject;return t.pipe(o.tap(function(t){return t?t.continue():e.next()}),o.filter(function(t){return!!t}),o.map(function(t){return t.value}),o.bufferWhen(function(){return e}),o.take(1))},t.prototype.set=function(t,e){var r=this;return this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(r.name)}),o.map(function(r){return r.put(t,e)}),o.switchMap(function(t){return i.rxifyRequest(t)}),i.resultFromIDBEvent,o.switchMap(function(t){return r._refreshDataStream(t,e)}))},t.prototype.tx=function(t){return void 0===t&&(t="readonly"),this._db.tx(this.name,t)},t.prototype._refreshDataStream=function(t,e){var r=this;return void 0===e&&(e="__each__"),this.getAll().pipe(o.take(1),o.tap(function(t){r._dataTs$.next(Date.now()),r._dataUpdate$.next(t),r._dataUpdateKey$.next(e)}),o.mapTo(t))},t.prototype._getUpdatesFor=function(t){return this._dataUpdateKey$.pipe(o.filter(function(e){return t===e}))},t}();e.RxIDBStore=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),o=r(1),i=r(2),u=function(){function t(t){this.idb=t,this._storeCache={}}return t.prototype.close=function(){this.idb.close()},t.prototype.get=function(t){return this._storeCache[t]?this._storeCache[t]:this._storeCache[t]=new i.RxIDBStore(t,this)},t.prototype.tx=function(t,e){var r=this;return void 0===e&&(e="readonly"),n.of(null).pipe(o.map(function(){return r.idb.transaction(t,e)}))},t.prototype.transaction=function(t,e){return void 0===e&&(e="readonly"),this.idb.transaction(t,e)},t}();e.RxIDB=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o._store=n,o}return n(e,t),e.prototype.createIndex=function(t,e,r){return this._store.createIndex(t,e,r)},e.prototype.fill=function(t){var e=this;return Array.from(t).forEach(function(t){return e._store.put(t)}),this},e}(r(2).RxIDBStore);e.RxIDBUpgradeStore=o;var i=function(){function t(t,e){this._rxidb=t,this.db=e.target.result,this.oldVersion=e.oldVersion,this.version=e.newVersion}return t.prototype.create=function(t,e){var r=this.db.createObjectStore(t,e);return new o(t,this._rxidb,r)},t.prototype.delete=function(t){this.db.deleteObjectStore(t)},t.prototype.has=function(t){return this.db.objectStoreNames.contains(t)},t}();e.RxIDBUpgrade=i},function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(3)),n(r(2)),n(r(4));var o=r(7);e.openDB=o.openDB,e.dropDB=o.dropDB},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),o=r(1);e.rxifyRequest=function(t,e,r){void 0===e&&(e=["onsuccess"]),void 0===r&&(r=["onerror"]);var o=new n.Subject;return e.forEach(function(e){return t[e]=function(t){return o.next(t)}}),r.forEach(function(e){return t[e]=function(t){return o.error(t)}}),o},e.resultFromIDBEvent=function(t){return t.pipe(o.map(function(t){return t.target.result}))}},function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)u.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return u};Object.defineProperty(e,"__esModule",{value:!0});var i=r(0),u=r(1),a=r(3),c=r(4);function s(t,e,r){var n,o=new i.Subject,s=new i.Subject,f=function(t){return o.error(t)},d=function(t){return o.error(t)},l=function(t){n=n||new a.RxIDB(t.target.result),o.next(n),o.complete(),e===n.idb.version?(s.next(),s.complete()):s.error("Upgrade error")};return i.of(null).pipe(u.map(function(){return indexedDB.open(t,e)}),u.switchMap(function(t){return Object.assign(t,{onerror:f,onblocked:d,onsuccess:l,onupgradeneeded:function(t){return function(t){n=n||new a.RxIDB(t.target.result),p(new c.RxIDBUpgrade(n,t),r).subscribe(function(){return s.next()},function(t){return s.error(t)},function(){return s.complete()})}(t)}}),i.forkJoin([o,s]).pipe(u.map(function(){return n}))}))}function p(t,e){return e&&e.length?i.forkJoin(e.map(function(e){return f(t,e)})):i.of(null)}function f(t,e){var r,u;void 0===e&&(e=new Map);var a=t.oldVersion,c=[i.of(!0)];try{for(var s=n(e),p=s.next();!p.done;p=s.next()){var f=o(p.value,2),d=f[0],l=f[1];if(a<d){var h=l(t);h instanceof i.Observable&&c.push(h)}}}catch(t){r={error:t}}finally{try{p&&!p.done&&(u=s.return)&&u.call(s)}finally{if(r)throw r.error}}return c}function d(t){return i.Observable.create(function(e){var r=indexedDB.deleteDatabase(t);r.onblocked=function(t){return e.error(t)},r.onsuccess=function(){return e.next(void 0)},r.onerror=function(t){return e.error(t)}}).pipe(u.take(1))}e.openDB=s,e.onUpgradeNeeded=p,e.setupLayers=f,e.dropDB=d,e.rxidb={openDB:s,dropDB:d}}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yeGlkYi93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vcnhpZGIvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcnhpZGIvZXh0ZXJuYWwgXCJyeGpzXCIiLCJ3ZWJwYWNrOi8vcnhpZGIvZXh0ZXJuYWwgXCJyeGpzL29wZXJhdG9yc1wiIiwid2VicGFjazovL3J4aWRiLy4vc3JjL3J4aWRiLXN0b3JlLnRzIiwid2VicGFjazovL3J4aWRiLy4vc3JjL3J4aWRiLWRiLnRzIiwid2VicGFjazovL3J4aWRiLy4vc3JjL3J4aWRiLXVwZ3JhZGUudHMiLCJ3ZWJwYWNrOi8vcnhpZGIvLi9yeGlkYi50cyIsIndlYnBhY2s6Ly9yeGlkYi8uL3NyYy9yeGlkYi11dGlscy50cyIsIndlYnBhY2s6Ly9yeGlkYi8uL3NyYy9yeGlkYi1zdGF0aWMudHMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwicmVxdWlyZSIsImRlZmluZSIsImFtZCIsIndpbmRvdyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzBfXyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzFfXyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJyeGpzXzEiLCJvcGVyYXRvcnNfMSIsInJ4aWRiX3V0aWxzXzEiLCJSeElEQlN0b3JlIiwiX2RiIiwiX3RoaXMiLCJ0aGlzIiwiX2RhdGFVcGRhdGUkIiwiU3ViamVjdCIsIl9kYXRhVXBkYXRlS2V5JCIsImtleVBhdGgkIiwidHgiLCJwaXBlIiwibWFwIiwib2JqZWN0U3RvcmUiLCJzdG9yZSIsImtleVBhdGgiLCJkYXRhJCIsIm1lcmdlIiwiZ2V0QWxsIiwic2hhcmVSZXBsYXkiLCJfZGF0YVRzJCIsIkJlaGF2aW9yU3ViamVjdCIsImRhdGFUcyQiLCJhc09ic2VydmFibGUiLCJjbGVhciIsInN3aXRjaE1hcCIsInJlcSIsInJ4aWZ5UmVxdWVzdCIsInJlc3VsdCIsIl9yZWZyZXNoRGF0YVN0cmVhbSIsInRha2UiLCJtYXBUbyIsInVuZGVmaW5lZCIsImN1cnNvciIsInJhbmdlIiwiZGlyZWN0aW9uIiwib3BlbkN1cnNvciIsInJlc3VsdEZyb21JREJFdmVudCIsImRlbGV0ZSIsInJlc2V0IiwiY29sbGVjdGlvbiIsInB1dCIsInRhc2tzIiwiZm9ya0pvaW4iLCJvZiIsIl9nZXRVcGRhdGVzRm9yIiwiY3Vyc29yJCIsImRvbmUkIiwidGFwIiwiY29udGludWUiLCJuZXh0IiwiZmlsdGVyIiwiYnVmZmVyV2hlbiIsInNldCIsImRhdGEiLCJEYXRlIiwibm93IiwiX2tleSIsInJ4aWRiX3N0b3JlXzEiLCJSeElEQiIsImlkYiIsIl9zdG9yZUNhY2hlIiwiY2xvc2UiLCJ0cmFuc2FjdGlvbiIsIlJ4SURCVXBncmFkZVN0b3JlIiwiX3N1cGVyIiwiX25hbWUiLCJfcnhpZGIiLCJfc3RvcmUiLCJfX2V4dGVuZHMiLCJjcmVhdGVJbmRleCIsImtleXBhdGgiLCJwYXJhbXMiLCJmaWxsIiwiZW50cmllcyIsIkFycmF5IiwiZnJvbSIsImZvckVhY2giLCJlbnRyeSIsIlJ4SURCVXBncmFkZSIsIl9ldmVudCIsImRiIiwidGFyZ2V0Iiwib2xkVmVyc2lvbiIsInZlcnNpb24iLCJuZXdWZXJzaW9uIiwib3B0aW9ucyIsImNyZWF0ZU9iamVjdFN0b3JlIiwiZGVsZXRlT2JqZWN0U3RvcmUiLCJoYXMiLCJvYmplY3RTdG9yZU5hbWVzIiwiY29udGFpbnMiLCJfX2V4cG9ydCIsInJ4aWRiX3N0YXRpY18xIiwib3BlbkRCIiwiZHJvcERCIiwicmVxdWVzdCIsInN1Y2Nlc3NDYnMiLCJlcnJvckNicyIsInJlcXVlc3QkIiwiZSIsImVycm9yIiwic291cmNlIiwicnhpZGJfZGJfMSIsInJ4aWRiX3VwZ3JhZGVfMSIsImRiTmFtZSIsImRiVmVyc2lvbiIsInN0b3JlcyIsInJ4SURCIiwiZGIkIiwidXBncmFkZSQiLCJfb25FcnJvciIsIl9vbkJsb2NrZWQiLCJfb25TdWNjZXNzIiwiZXZlbnQiLCJjb21wbGV0ZSIsImluZGV4ZWREQiIsIm9wZW4iLCJhc3NpZ24iLCJvbmVycm9yIiwib25ibG9ja2VkIiwib25zdWNjZXNzIiwib251cGdyYWRlbmVlZGVkIiwib25VcGdyYWRlTmVlZGVkIiwic3Vic2NyaWJlIiwiX29uVXBncmFkZU5lZWRlZCIsInJ4SURCVXBncmFkZSIsImxlbmd0aCIsImxheWVycyIsInNldHVwTGF5ZXJzIiwiTWFwIiwib2JzZXJ2YWJsZXMiLCJsYXllcnNfMSIsIl9fdmFsdWVzIiwibGF5ZXJzXzFfMSIsImRvbmUiLCJfYiIsIl9fcmVhZCIsImxheWVyVmVyc2lvbiIsImxheWVySW5zdGFsbGVyIiwiT2JzZXJ2YWJsZSIsInB1c2giLCJvYnNlcnZlciIsImRlbGV0ZURhdGFiYXNlIiwicnhpZGIiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0EsaUJBQUFDLFNBQUEsaUJBQUFDLE9BQ0FBLE9BQUFELFFBQUFELEVBQUFHLFFBQUEsUUFBQUEsUUFBQSxtQkFDQSxtQkFBQUMsZUFBQUMsSUFDQUQsUUFBQSx5QkFBQUosR0FDQSxpQkFBQUMsUUFDQUEsUUFBQSxNQUFBRCxFQUFBRyxRQUFBLFFBQUFBLFFBQUEsbUJBRUFKLEVBQUEsTUFBQUMsRUFBQUQsRUFBQSxLQUFBQSxFQUFBLG1CQVJBLENBU0NPLE9BQUEsU0FBQUMsRUFBQUMsR0FDRCxtQkNU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RUFBU3pDLE1BQU1ELE1BQ3ZDekYsS0FBS1gsRUFBQThCLEtBQUssSUFoRmYxRSxFQUFBMEksU0FnREExSSxFQUFBdUssa0JBUUF2SyxFQUFBNkssY0FpQkE3SyxFQUFBMkksU0FVYTNJLEVBQUE0TCxPQUFVbEQsT0FBTUEsRUFBRUMsT0FBTUEiLCJmaWxlIjoicnhpZGIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJyeGpzXCIpLCByZXF1aXJlKFwicnhqcy9vcGVyYXRvcnNcIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW1wicnhqc1wiLCBcInJ4anMvb3BlcmF0b3JzXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInJ4aWRiXCJdID0gZmFjdG9yeShyZXF1aXJlKFwicnhqc1wiKSwgcmVxdWlyZShcInJ4anMvb3BlcmF0b3JzXCIpKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJyeGlkYlwiXSA9IGZhY3Rvcnkocm9vdFtcInJ4anNcIl0sIHJvb3RbXCJyeGpzL29wZXJhdG9yc1wiXSk7XG59KSh3aW5kb3csIGZ1bmN0aW9uKF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzBfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMV9fKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDUpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18wX187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xX187IiwiaW1wb3J0IHsgT2JzZXJ2YWJsZSwgU3ViamVjdCwgbWVyZ2UsIGZvcmtKb2luLCBCZWhhdmlvclN1YmplY3QsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAsIHN3aXRjaE1hcCwgbWFwVG8sIHRhcCwgZmlsdGVyLCBidWZmZXJXaGVuLCBzaGFyZVJlcGxheSwgdGFrZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgUnhJREIgfSBmcm9tICcuL3J4aWRiLWRiJztcbmltcG9ydCB7IElSeElEQlN0b3JlIH0gZnJvbSAnLi9yeGlkYi5pbnRlcmZhY2VzJztcbmltcG9ydCB7IHJ4aWZ5UmVxdWVzdCwgcmVzdWx0RnJvbUlEQkV2ZW50IH0gZnJvbSAnLi9yeGlkYi11dGlscyc7XG5cbmV4cG9ydCB0eXBlIFJ4SURCQ3Vyc29yUmFuZ2UgPSBzdHJpbmcgfCBudW1iZXIgfCBJREJLZXlSYW5nZSB8IERhdGUgfCBJREJBcnJheUtleSB8IHVuZGVmaW5lZDtcblxuY29uc3QgVVBEQVRFX0VBQ0g6IHN0cmluZyA9ICdfX2VhY2hfXyc7XG5cbmV4cG9ydCBjbGFzcyBSeElEQlN0b3JlPE1vZGVsID0gYW55PiBpbXBsZW1lbnRzIElSeElEQlN0b3JlIHtcbiAgcHJpdmF0ZSBfZGF0YVVwZGF0ZSQ6IFN1YmplY3Q8TW9kZWxbXT4gPSBuZXcgU3ViamVjdCgpO1xuXG4gIHByaXZhdGUgX2RhdGFVcGRhdGVLZXkkOiBTdWJqZWN0PElEQlZhbGlkS2V5PiA9IG5ldyBTdWJqZWN0KCk7XG5cbiAgcHVibGljIGtleVBhdGgkID0gdGhpcy50eCgncmVhZHdyaXRlJykucGlwZShcbiAgICBtYXAoKHR4KSA9PiB0eC5vYmplY3RTdG9yZSh0aGlzLm5hbWUpKSxcbiAgICBtYXAoKHN0b3JlKSA9PiBzdG9yZS5rZXlQYXRoKVxuICApIGFzIE9ic2VydmFibGU8c3RyaW5nfG51bGw+O1xuXG4gIHB1YmxpYyBkYXRhJDogT2JzZXJ2YWJsZTxNb2RlbFtdPiA9IG1lcmdlKFxuICAgIHRoaXMuZ2V0QWxsKCksXG4gICAgdGhpcy5fZGF0YVVwZGF0ZSRcbiAgKS5waXBlKFxuICAgIHNoYXJlUmVwbGF5KDEpXG4gICk7XG5cbiAgLyoqXG4gICAqIFN0cmVhbTogZGF0YSBjaGFuZ2UgdGltZSBzdGFtcFxuICAgKi9cbiAgcHJpdmF0ZSBfZGF0YVRzJDogQmVoYXZpb3JTdWJqZWN0PG51bWJlcj4gPSBuZXcgQmVoYXZpb3JTdWJqZWN0KC0xKTtcbiAgcHVibGljIGRhdGFUcyQ6IE9ic2VydmFibGU8bnVtYmVyPiA9IHRoaXMuX2RhdGFUcyQuYXNPYnNlcnZhYmxlKCk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIG5hbWU6IHN0cmluZyxcbiAgICBwcml2YXRlIF9kYjogUnhJREJcbiAgKSB7fVxuXG4gIHB1YmxpYyBjbGVhcigpOiBPYnNlcnZhYmxlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy50eCgncmVhZHdyaXRlJykucGlwZShcbiAgICAgIG1hcCgodHgpID0+IHR4Lm9iamVjdFN0b3JlKHRoaXMubmFtZSkpLFxuICAgICAgbWFwKChzdG9yZSkgPT4gc3RvcmUuY2xlYXIoKSksXG4gICAgICBzd2l0Y2hNYXAocmVxID0+IHJ4aWZ5UmVxdWVzdChyZXEpKSxcbiAgICAgIHN3aXRjaE1hcChyZXN1bHQgPT4gdGhpcy5fcmVmcmVzaERhdGFTdHJlYW0ocmVzdWx0KSksXG4gICAgICB0YWtlKDEpLFxuICAgICAgbWFwVG8odW5kZWZpbmVkKVxuICAgICk7XG4gIH1cblxuICBwdWJsaWMgY3Vyc29yKFxuICAgIG1vZGU6ICdyZWFkb25seSd8J3JlYWR3cml0ZScgPSAncmVhZG9ubHknLFxuICAgIHJhbmdlPzogUnhJREJDdXJzb3JSYW5nZSxcbiAgICBkaXJlY3Rpb24/OiBJREJDdXJzb3JEaXJlY3Rpb25cbiAgKTogT2JzZXJ2YWJsZTxJREJDdXJzb3JXaXRoVmFsdWU+IHtcbiAgICByZXR1cm4gdGhpcy50eChtb2RlKS5waXBlKFxuICAgICAgbWFwKHR4ID0+IHR4Lm9iamVjdFN0b3JlKHRoaXMubmFtZSkpLFxuICAgICAgbWFwKHN0b3JlID0+IHN0b3JlLm9wZW5DdXJzb3IocmFuZ2UsIGRpcmVjdGlvbikpLFxuICAgICAgc3dpdGNoTWFwKHJlcSA9PiByeGlmeVJlcXVlc3QocmVxKSksXG4gICAgICByZXN1bHRGcm9tSURCRXZlbnRcbiAgICApO1xuICB9XG5cbiAgcHVibGljIGRlbGV0ZShrZXk6IElEQlZhbGlkS2V5KTogT2JzZXJ2YWJsZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMudHgoJ3JlYWR3cml0ZScpLnBpcGUoXG4gICAgICBtYXAoKHR4KSA9PiB0eC5vYmplY3RTdG9yZSh0aGlzLm5hbWUpKSxcbiAgICAgIG1hcCgoc3RvcmUpID0+IHN0b3JlLmRlbGV0ZShrZXkpKSxcbiAgICAgIHN3aXRjaE1hcChyZXEgPT4gcnhpZnlSZXF1ZXN0KHJlcSkpLFxuICAgICAgc3dpdGNoTWFwKHJlc3VsdCA9PiB0aGlzLl9yZWZyZXNoRGF0YVN0cmVhbShyZXN1bHQsIGtleSkpLFxuICAgICAgdGFrZSgxKSxcbiAgICAgIG1hcFRvKHVuZGVmaW5lZClcbiAgICApO1xuICB9XG5cbiAgcHVibGljIHJlc2V0KGNvbGxlY3Rpb246IGFueVtdKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy50eCgncmVhZHdyaXRlJykucGlwZShcbiAgICAgIG1hcCgodHgpID0+IHR4Lm9iamVjdFN0b3JlKHRoaXMubmFtZSkpLFxuICAgICAgc3dpdGNoTWFwKHN0b3JlID0+IHJ4aWZ5UmVxdWVzdChzdG9yZS5jbGVhcigpKS5waXBlKHRha2UoMSksIG1hcFRvKHN0b3JlKSkpLFxuICAgICAgbWFwKHN0b3JlID0+IHtcbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb24ubWFwKHZhbHVlID0+IHtcbiAgICAgICAgICByZXR1cm4gcnhpZnlSZXF1ZXN0KHN0b3JlLnB1dCh2YWx1ZSkpLnBpcGUoXG4gICAgICAgICAgICB0YWtlKDEpLFxuICAgICAgICAgICAgcmVzdWx0RnJvbUlEQkV2ZW50XG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgICB9KSxcbiAgICAgIHN3aXRjaE1hcCgodGFza3M6IE9ic2VydmFibGU8YW55PltdKSA9PiBmb3JrSm9pbih0YXNrcykpLFxuICAgICAgc3dpdGNoTWFwKHJlc3VsdCA9PiB0aGlzLl9yZWZyZXNoRGF0YVN0cmVhbShyZXN1bHQsIFVQREFURV9FQUNIKSksXG4gICAgICB0YWtlKDEpXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQoa2V5OiBJREJWYWxpZEtleSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIG1lcmdlKG9mKG51bGwpLCB0aGlzLl9nZXRVcGRhdGVzRm9yKGtleSkpLnBpcGUoXG4gICAgICBzd2l0Y2hNYXAoKCkgPT4gdGhpcy50eCgpKSxcbiAgICAgIG1hcCgodHgpID0+IHR4Lm9iamVjdFN0b3JlKHRoaXMubmFtZSkpLFxuICAgICAgbWFwKHN0b3JlID0+IHN0b3JlLmdldChrZXkpKSxcbiAgICAgIHN3aXRjaE1hcChyZXEgPT4gcnhpZnlSZXF1ZXN0KHJlcSkpLFxuICAgICAgcmVzdWx0RnJvbUlEQkV2ZW50XG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRBbGwoKTogT2JzZXJ2YWJsZTxNb2RlbFtdPiB7XG4gICAgbGV0IGN1cnNvciQgPSB0aGlzLmN1cnNvcigpO1xuICAgIGxldCBkb25lJCAgID0gbmV3IFN1YmplY3QoKTtcblxuICAgIHJldHVybiBjdXJzb3IkLnBpcGUoXG4gICAgICB0YXAoY3Vyc29yID0+ICEhY3Vyc29yID8gY3Vyc29yLmNvbnRpbnVlKCkgOiBkb25lJC5uZXh0KCkpLFxuICAgICAgZmlsdGVyKGN1cnNvciA9PiAhIWN1cnNvciksXG4gICAgICBtYXAoY3Vyc29yID0+IGN1cnNvci52YWx1ZSksXG4gICAgICBidWZmZXJXaGVuKCgpID0+IGRvbmUkKSxcbiAgICAgIHRha2UoMSlcbiAgICApO1xuICB9XG5cbiAgcHVibGljIHNldCh2YWx1ZTogYW55LCBrZXk/OiBJREJWYWxpZEtleSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMudHgoJ3JlYWR3cml0ZScpLnBpcGUoXG4gICAgICBtYXAoKHR4KSA9PiB0eC5vYmplY3RTdG9yZSh0aGlzLm5hbWUpKSxcbiAgICAgIG1hcChzdG9yZSA9PiBzdG9yZS5wdXQodmFsdWUsIGtleSkpLFxuICAgICAgc3dpdGNoTWFwKHJlcSA9PiByeGlmeVJlcXVlc3QocmVxKSksXG4gICAgICByZXN1bHRGcm9tSURCRXZlbnQsXG4gICAgICBzd2l0Y2hNYXAocmVzdWx0ID0+IHRoaXMuX3JlZnJlc2hEYXRhU3RyZWFtKHJlc3VsdCwga2V5KSlcbiAgICApO1xuICB9XG5cbiAgcHVibGljIHR4KG1vZGU6ICdyZWFkb25seScgfCAncmVhZHdyaXRlJyA9ICdyZWFkb25seScpOiBPYnNlcnZhYmxlPElEQlRyYW5zYWN0aW9uPiB7XG4gICAgcmV0dXJuIHRoaXMuX2RiLnR4KHRoaXMubmFtZSwgbW9kZSk7XG4gIH1cblxuICAvKipcbiAgICogVHJpZ2dlciB1cGRhdGUgc3RyZWFtXG4gICAqL1xuICBwcml2YXRlIF9yZWZyZXNoRGF0YVN0cmVhbTxUPihyZXN1bHQ6IFQsIGtleTogSURCVmFsaWRLZXkgPSBVUERBVEVfRUFDSCk6IE9ic2VydmFibGU8VD4ge1xuICAgIHJldHVybiB0aGlzLmdldEFsbCgpLnBpcGUoXG4gICAgICB0YWtlKDEpLFxuICAgICAgdGFwKChkYXRhKSA9PiB7XG4gICAgICAgIHRoaXMuX2RhdGFUcyQubmV4dChEYXRlLm5vdygpKTtcbiAgICAgICAgdGhpcy5fZGF0YVVwZGF0ZSQubmV4dChkYXRhKTtcbiAgICAgICAgdGhpcy5fZGF0YVVwZGF0ZUtleSQubmV4dChrZXkpO1xuICAgICAgfSksXG4gICAgICBtYXBUbyhyZXN1bHQpXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgX2dldFVwZGF0ZXNGb3Ioa2V5OiBJREJWYWxpZEtleSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuX2RhdGFVcGRhdGVLZXkkLnBpcGUoXG4gICAgICBmaWx0ZXIoX2tleSA9PiBrZXkgPT09IF9rZXkpXG4gICAgKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgSVJ4SURCIH0gZnJvbSAnLi9yeGlkYi5pbnRlcmZhY2VzJztcbmltcG9ydCB7IFJ4SURCU3RvcmUgfSBmcm9tICcuL3J4aWRiLXN0b3JlJztcblxuZXhwb3J0IGNsYXNzIFJ4SURCIGltcGxlbWVudHMgSVJ4SURCIHtcbiAgcHJpdmF0ZSBfc3RvcmVDYWNoZToge1trZXk6IHN0cmluZ106IFJ4SURCU3RvcmV9ID0ge307XG5cbiAgY29uc3RydWN0b3IgKFxuICAgIHB1YmxpYyByZWFkb25seSBpZGI6IElEQkRhdGFiYXNlXG4gICkge31cblxuICAvKipcbiAgICogQ2xvc2UgZGJcbiAgICovXG4gIHB1YmxpYyBjbG9zZSgpOiB2b2lkIHtcbiAgICB0aGlzLmlkYi5jbG9zZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzdG9yZVxuICAgKi9cbiAgcHVibGljIGdldChrZXk6IHN0cmluZyk6IFJ4SURCU3RvcmUge1xuICAgIGlmICh0aGlzLl9zdG9yZUNhY2hlW2tleV0pIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdG9yZUNhY2hlW2tleV07XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX3N0b3JlQ2FjaGVba2V5XSA9IG5ldyBSeElEQlN0b3JlKGtleSwgdGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogU3RyZWFtOiBJREJUcmFuc2FjdGlvblxuICAgKi9cbiAgcHVibGljIHR4KFxuICAgIHN0b3JlOiBzdHJpbmcgfCBzdHJpbmdbXSxcbiAgICBtb2RlOiAncmVhZG9ubHknIHwgJ3JlYWR3cml0ZScgPSAncmVhZG9ubHknXG4gICk6IE9ic2VydmFibGU8SURCVHJhbnNhY3Rpb24+IHtcbiAgICByZXR1cm4gb2YobnVsbCkucGlwZShcbiAgICAgIG1hcCgoKSA9PiB0aGlzLmlkYi50cmFuc2FjdGlvbihzdG9yZSwgbW9kZSkpXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVuIElEQlRyYW5zYWN0aW9uXG4gICAqL1xuICBwdWJsaWMgdHJhbnNhY3Rpb24oXG4gICAgc3RvcmU6IHN0cmluZ3xzdHJpbmdbXSxcbiAgICBtb2RlOiAncmVhZG9ubHknfCdyZWFkd3JpdGUnID0gJ3JlYWRvbmx5J1xuICApOiBJREJUcmFuc2FjdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuaWRiLnRyYW5zYWN0aW9uKHN0b3JlLCBtb2RlKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUnhJREIgfSBmcm9tICcuL3J4aWRiLWRiJztcbmltcG9ydCB7IFJ4SURCU3RvcmUgfSBmcm9tICcuL3J4aWRiLXN0b3JlJztcbmltcG9ydCB7IElSeElEQlVwZ3JhZGUgfSBmcm9tICcuL3J4aWRiLmludGVyZmFjZXMnO1xuXG5leHBvcnQgY2xhc3MgUnhJREJVcGdyYWRlU3RvcmUgZXh0ZW5kcyBSeElEQlN0b3JlIHtcbiAgY29uc3RydWN0b3IoXG4gICAgX25hbWU6IHN0cmluZyxcbiAgICBfcnhpZGI6IFJ4SURCLFxuICAgIHByaXZhdGUgX3N0b3JlOiBJREJPYmplY3RTdG9yZVxuICApIHtcbiAgICBzdXBlcihfbmFtZSwgX3J4aWRiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgaW5kZXhcbiAgICovXG4gIHB1YmxpYyBjcmVhdGVJbmRleChuYW1lOiBzdHJpbmcsIGtleXBhdGg6IHN0cmluZywgcGFyYW1zPzogSURCSW5kZXhQYXJhbWV0ZXJzKTogSURCSW5kZXgge1xuICAgIHJldHVybiB0aGlzLl9zdG9yZS5jcmVhdGVJbmRleChuYW1lLCBrZXlwYXRoLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbGwgREIgd2l0aCBlbnRyaWVzXG4gICAqL1xuICBwdWJsaWMgZmlsbChlbnRyaWVzOiBJdGVyYWJsZTxhbnk+KTogdGhpcyB7XG4gICAgQXJyYXkuZnJvbShlbnRyaWVzKS5mb3JFYWNoKGVudHJ5ID0+IHRoaXMuX3N0b3JlLnB1dChlbnRyeSkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSeElEQlVwZ3JhZGUgaW1wbGVtZW50cyBJUnhJREJVcGdyYWRlIHtcbiAgcHVibGljIHJlYWRvbmx5IGRiOiBJREJEYXRhYmFzZTtcbiAgcHVibGljIHJlYWRvbmx5IG9sZFZlcnNpb246IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IHZlcnNpb246IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvciAoXG4gICAgcHJpdmF0ZSBfcnhpZGI6IFJ4SURCLFxuICAgIF9ldmVudDogYW55XG4gICkge1xuICAgIHRoaXMuZGIgICAgICAgICA9IF9ldmVudC50YXJnZXQucmVzdWx0O1xuICAgIHRoaXMub2xkVmVyc2lvbiA9IF9ldmVudC5vbGRWZXJzaW9uO1xuICAgIHRoaXMudmVyc2lvbiAgICA9IF9ldmVudC5uZXdWZXJzaW9uO1xuICB9XG5cbiAgcHVibGljIGNyZWF0ZShuYW1lOiBzdHJpbmcsIG9wdGlvbnM/OiBJREJPYmplY3RTdG9yZVBhcmFtZXRlcnMpOiBSeElEQlVwZ3JhZGVTdG9yZSB7XG4gICAgbGV0IHN0b3JlID0gdGhpcy5kYi5jcmVhdGVPYmplY3RTdG9yZShuYW1lLCBvcHRpb25zKTtcbiAgICByZXR1cm4gbmV3IFJ4SURCVXBncmFkZVN0b3JlKG5hbWUsIHRoaXMuX3J4aWRiLCBzdG9yZSk7XG4gIH1cblxuICBwdWJsaWMgZGVsZXRlKG5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuZGIuZGVsZXRlT2JqZWN0U3RvcmUobmFtZSk7XG4gIH1cblxuICBwdWJsaWMgaGFzKG5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMobmFtZSk7XG4gIH1cbn1cbiIsImV4cG9ydCAqIGZyb20gJy4vc3JjL3J4aWRiLnR5cGVzJztcbmV4cG9ydCAqIGZyb20gJy4vc3JjL3J4aWRiLWRiJztcbmV4cG9ydCAqIGZyb20gJy4vc3JjL3J4aWRiLXN0b3JlJztcbmV4cG9ydCAqIGZyb20gJy4vc3JjL3J4aWRiLXVwZ3JhZGUnO1xuZXhwb3J0IHsgb3BlbkRCLCBkcm9wREIgfSBmcm9tICcuL3NyYy9yeGlkYi1zdGF0aWMnO1xuIiwiaW1wb3J0IHsgU3ViamVjdCwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG4vKipcbiAqIFJlc29sdmUgcmVxdWVzdCBhcyBhbiBPYnNlcnZhYmxlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByeGlmeVJlcXVlc3QoXG4gIHJlcXVlc3Q6IElEQlJlcXVlc3QsXG4gIHN1Y2Nlc3NDYnM6IGFueVtdID0gWydvbnN1Y2Nlc3MnXSxcbiAgZXJyb3JDYnM6IGFueVtdID0gWydvbmVycm9yJ11cbik6IE9ic2VydmFibGU8YW55PiB7XG4gIGxldCByZXF1ZXN0JDogU3ViamVjdDxhbnk+ID0gbmV3IFN1YmplY3QoKTtcblxuICBzdWNjZXNzQ2JzLmZvckVhY2goa2V5ID0+IHJlcXVlc3Rba2V5XSA9IChlOiBhbnkpID0+IHJlcXVlc3QkLm5leHQoZSkpO1xuICBlcnJvckNicy5mb3JFYWNoKGtleSA9PiByZXF1ZXN0W2tleV0gPSAoZTogYW55KSA9PiByZXF1ZXN0JC5lcnJvcihlKSk7XG5cbiAgcmV0dXJuIHJlcXVlc3QkO1xufVxuXG4vKipcbiAqIFBpcGUgb3BlcmF0b3IgZm9yIGV4dHJhY3RpbmcgcmVzdWx0IGZyb20gaWRiIGV2ZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXN1bHRGcm9tSURCRXZlbnQoc291cmNlOiBPYnNlcnZhYmxlPGFueT4pIHtcbiAgcmV0dXJuIHNvdXJjZS5waXBlKFxuICAgIG1hcCgoZTogYW55KSA9PiBlLnRhcmdldC5yZXN1bHQpXG4gICk7XG59XG4iLCJpbXBvcnQgeyBPYnNlcnZhYmxlLCBmb3JrSm9pbiwgU3ViamVjdCwgb2YsIE9ic2VydmVyIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyB0YWtlLCBtYXAsIHN3aXRjaE1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgUnhJREIgfSBmcm9tICcuL3J4aWRiLWRiJztcbmltcG9ydCB7IFJ4SURCTGF5ZXJzIH0gZnJvbSAnLi9yeGlkYi50eXBlcyc7XG5pbXBvcnQgeyBSeElEQlVwZ3JhZGUgfSBmcm9tICcuL3J4aWRiLXVwZ3JhZGUnO1xuXG5leHBvcnQgZnVuY3Rpb24gb3BlbkRCKGRiTmFtZTogc3RyaW5nLCBkYlZlcnNpb246IG51bWJlciwgc3RvcmVzPzogUnhJREJMYXllcnNbXSk6IE9ic2VydmFibGU8UnhJREI+IHtcbiAgbGV0IGRiJDogU3ViamVjdDxSeElEQj4gPSBuZXcgU3ViamVjdCgpO1xuICBsZXQgdXBncmFkZSQ6IFN1YmplY3Q8dm9pZD4gPSBuZXcgU3ViamVjdCgpO1xuICBsZXQgcnhJREI6IFJ4SURCO1xuXG4gIGxldCBfb25FcnJvciAgID0gKGU6IGFueSkgPT4gZGIkLmVycm9yKGUpO1xuICBsZXQgX29uQmxvY2tlZCA9IChlOiBhbnkpID0+IGRiJC5lcnJvcihlKTtcblxuICBsZXQgX29uU3VjY2VzcyA9IChldmVudDogYW55KSA9PiB7XG4gICAgcnhJREIgPSByeElEQiB8fCBuZXcgUnhJREIoZXZlbnQudGFyZ2V0LnJlc3VsdCk7XG4gICAgZGIkLm5leHQocnhJREIpO1xuICAgIGRiJC5jb21wbGV0ZSgpO1xuXG4gICAgaWYgKGRiVmVyc2lvbiA9PT0gcnhJREIuaWRiLnZlcnNpb24pIHtcbiAgICAgIHVwZ3JhZGUkLm5leHQoKTtcbiAgICAgIHVwZ3JhZGUkLmNvbXBsZXRlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHVwZ3JhZGUkLmVycm9yKCdVcGdyYWRlIGVycm9yJyk7XG4gICAgfVxuICB9O1xuXG4gIGxldCBfb25VcGdyYWRlTmVlZGVkID0gKGV2ZW50OiBhbnkpID0+IHtcbiAgICByeElEQiA9IHJ4SURCIHx8IG5ldyBSeElEQihldmVudC50YXJnZXQucmVzdWx0KTtcblxuICAgIG9uVXBncmFkZU5lZWRlZChuZXcgUnhJREJVcGdyYWRlKHJ4SURCLCBldmVudCksIHN0b3Jlcykuc3Vic2NyaWJlKFxuICAgICAgKCkgID0+IHVwZ3JhZGUkLm5leHQoKSxcbiAgICAgIChlKSA9PiB1cGdyYWRlJC5lcnJvcihlKSxcbiAgICAgICgpICA9PiB1cGdyYWRlJC5jb21wbGV0ZSgpXG4gICAgKTtcbiAgfTtcblxuICByZXR1cm4gb2YobnVsbCkucGlwZShcbiAgICBtYXAoKCkgPT4gaW5kZXhlZERCLm9wZW4oZGJOYW1lLCBkYlZlcnNpb24pKSxcbiAgICBzd2l0Y2hNYXAoKHJlcXVlc3Q6IElEQk9wZW5EQlJlcXVlc3QpID0+IHtcbiAgICAgIE9iamVjdC5hc3NpZ24ocmVxdWVzdCwge1xuICAgICAgICBvbmVycm9yICAgICAgICA6IF9vbkVycm9yLFxuICAgICAgICBvbmJsb2NrZWQgICAgICA6IF9vbkJsb2NrZWQsXG4gICAgICAgIG9uc3VjY2VzcyAgICAgIDogX29uU3VjY2VzcyxcbiAgICAgICAgb251cGdyYWRlbmVlZGVkIDogKGU6IGFueSkgPT4gX29uVXBncmFkZU5lZWRlZChlKVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBmb3JrSm9pbihbZGIkLCB1cGdyYWRlJF0pLnBpcGUoXG4gICAgICAgIG1hcCgoKSA9PiByeElEQilcbiAgICAgICk7XG4gICAgfSlcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG9uVXBncmFkZU5lZWRlZChyeElEQlVwZ3JhZGU6IFJ4SURCVXBncmFkZSwgc3RvcmVzPzogUnhJREJMYXllcnNbXSk6IE9ic2VydmFibGU8YW55PiB7XG4gIGlmICghc3RvcmVzIHx8ICFzdG9yZXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIG9mKG51bGwpO1xuICB9XG5cbiAgcmV0dXJuIGZvcmtKb2luKHN0b3Jlcy5tYXAobGF5ZXJzID0+IHNldHVwTGF5ZXJzKHJ4SURCVXBncmFkZSwgbGF5ZXJzKSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBMYXllcnMocnhJREJVcGdyYWRlOiBSeElEQlVwZ3JhZGUsIGxheWVyczogUnhJREJMYXllcnMgPSBuZXcgTWFwKCkpOiBPYnNlcnZhYmxlPGFueT5bXSB7XG4gIGxldCB7IG9sZFZlcnNpb24gfSA9IHJ4SURCVXBncmFkZTtcbiAgbGV0IG9ic2VydmFibGVzOiBPYnNlcnZhYmxlPGFueT5bXSA9IFtvZih0cnVlKV07XG5cbiAgZm9yIChjb25zdCBbbGF5ZXJWZXJzaW9uLCBsYXllckluc3RhbGxlcl0gb2YgbGF5ZXJzKSB7XG4gICAgaWYgKG9sZFZlcnNpb24gPCBsYXllclZlcnNpb24pIHtcbiAgICAgIGxldCByZXN1bHQgPSBsYXllckluc3RhbGxlcihyeElEQlVwZ3JhZGUpO1xuXG4gICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgT2JzZXJ2YWJsZSkge1xuICAgICAgICBvYnNlcnZhYmxlcy5wdXNoKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG9ic2VydmFibGVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZHJvcERCKGRiTmFtZTogc3RyaW5nKTogT2JzZXJ2YWJsZTx2b2lkPiB7XG4gIHJldHVybiBPYnNlcnZhYmxlLmNyZWF0ZSgob2JzZXJ2ZXI6IE9ic2VydmVyPHZvaWQ+KSA9PiB7XG4gICAgbGV0IHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoZGJOYW1lKTtcblxuICAgIHJlcXVlc3Qub25ibG9ja2VkID0gKGUpID0+IG9ic2VydmVyLmVycm9yKGUpO1xuICAgIHJlcXVlc3Qub25zdWNjZXNzID0gKCkgPT4gb2JzZXJ2ZXIubmV4dCh1bmRlZmluZWQpO1xuICAgIHJlcXVlc3Qub25lcnJvciA9IChlKSA9PiBvYnNlcnZlci5lcnJvcihlKTtcbiAgfSkucGlwZSh0YWtlKDEpKTtcbn1cblxuZXhwb3J0IGNvbnN0IHJ4aWRiID0geyBvcGVuREIsIGRyb3BEQiB9O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==