!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e){t.exports=rxjs/operators},function(t,e){t.exports=rxjs},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(6),u=function(){function t(t,e){var r=this;this.name=t,this._db=e,this._update$=new n.Subject,this.update$=this._update$.asObservable(),this.data$=n.merge(this.getAll(),this._update$.pipe(o.switchMap(function(){return r.getAll()}))).pipe(o.shareReplay(1))}return t.prototype.clear=function(){var t=this;return this.tx("readwrite").pipe(o.map(function(e){return e.objectStore(t.name)}),o.map(function(t){return t.clear()}),o.switchMap(function(t){return i.rxifyRequest(t)}),o.tap(function(){return t._triggerUpdate()}),o.mapTo(void 0))},t.prototype.cursor=function(t,e,r){var n=this;return void 0===t&&(t="readonly"),this.tx(t).pipe(o.map(function(t){return t.objectStore(n.name)}),o.map(function(t){return t.openCursor(e,r)}),o.switchMap(function(t){return i.rxifyRequest(t)}),i.resultFromIDBEvent)},t.prototype.delete=function(t){var e=this;return this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(e.name)}),o.map(function(e){return e.delete(t)}),o.switchMap(function(t){return i.rxifyRequest(t)}),o.tap(function(){return e._triggerUpdate()}),o.mapTo(void 0))},t.prototype.reset=function(t){var e=this;return this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(e.name)}),o.switchMap(function(t){return i.rxifyRequest(t.clear()).pipe(o.take(1),o.mapTo(t))}),o.map(function(e){return t.map(function(t){return i.rxifyRequest(e.put(t)).pipe(o.take(1),i.resultFromIDBEvent)})}),o.switchMap(function(t){return n.forkJoin(t)}),o.tap(function(){return e._triggerUpdate()}))},t.prototype.get=function(t){var e=this;return this.tx().pipe(o.map(function(t){return t.objectStore(e.name)}),o.map(function(e){return e.get(t)}),o.switchMap(function(t){return i.rxifyRequest(t)}),i.resultFromIDBEvent)},t.prototype.getAll=function(){var t=this.cursor(),e=new n.Subject;return t.pipe(o.tap(function(t){return t?t.continue():e.next()}),o.filter(function(t){return!!t}),o.map(function(t){return t.value}),o.bufferWhen(function(){return e}),o.take(1))},t.prototype.set=function(t,e){var r=this;return this.tx("readwrite").pipe(o.map(function(t){return t.objectStore(r.name)}),o.map(function(r){return r.put(t,e)}),o.switchMap(function(t){return i.rxifyRequest(t)}),o.tap(function(){return r._triggerUpdate()}),i.resultFromIDBEvent)},t.prototype.tx=function(t){return void 0===t&&(t="readonly"),this._db.tx(this.name,t)},t.prototype._triggerUpdate=function(){this._update$.next()},t}();e.RxIDBStore=u},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return o._store=n,o}return o(e,t),e.prototype.createIndex=function(t,e,r){return this._store.createIndex(t,e,r)},e.prototype.fill=function(t){var e=this;return Array.from(t).forEach(function(t){return e._store.put(t)}),this},e}(r(2).RxIDBStore);e.RxIDBUpgradeStore=i;var u=function(){function t(t,e){this._rxidb=t,this.db=e.target.result,this.oldVersion=e.oldVersion,this.version=e.newVersion}return t.prototype.create=function(t,e){var r=this.db.createObjectStore(t,e);return new i(t,this._rxidb,r)},t.prototype.delete=function(t){this.db.deleteObjectStore(t)},t.prototype.has=function(t){return this.db.objectStoreNames.contains(t)},t}();e.RxIDBUpgrade=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),u=function(){function t(t){this.idb=t,this._storeCache={}}return t.prototype.close=function(){this.idb.close()},t.prototype.get=function(t){return this._storeCache[t]?this._storeCache[t]:this._storeCache[t]=new i.RxIDBStore(t,this)},t.prototype.tx=function(t,e){var r=this;return void 0===e&&(e="readonly"),n.of(null).pipe(o.map(function(){return r.idb.transaction(t,e)}))},t.prototype.transaction=function(t,e){return void 0===e&&(e="readonly"),this.idb.transaction(t,e)},t}();e.RxIDB=u},function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)u.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return u};Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),u=r(0),c=r(4),a=r(3);function p(t,e,r){var n,o=new i.Subject,p=new i.Subject,f=indexedDB.open(t,e);return f.onerror=function(t){return o.error(t)},f.onblocked=function(t){return o.error(t)},f.onsuccess=function(t){n=n||new c.RxIDB(t.target.result),o.next(n),o.complete(),e===n.idb.version&&(p.next(),p.complete())},f.onupgradeneeded=function(t){n=n||new c.RxIDB(t.target.result),s(new a.RxIDBUpgrade(n,t),r).subscribe(function(){return p.next()},function(t){return p.error(t)},function(){return p.complete()})},i.forkJoin([o,p]).pipe(u.map(function(){return n}))}function s(t,e){return e&&e.length?i.forkJoin(e.map(function(e){return f(t,e)})):i.of(null)}function f(t,e){var r,u;void 0===e&&(e=new Map);var c=t.oldVersion,a=[i.of(!0)];try{for(var p=n(e),s=p.next();!s.done;s=p.next()){var f=o(s.value,2),l=f[0],d=f[1];if(c<l){var h=d(t);h instanceof i.Observable&&a.push(h)}}}catch(t){r={error:t}}finally{try{s&&!s.done&&(u=p.return)&&u.call(p)}finally{if(r)throw r.error}}return a}function l(t){return i.Observable.create(function(e){var r=indexedDB.deleteDatabase(t);r.onblocked=function(t){return e.error(t)},r.onsuccess=function(){return e.next(void 0)},r.onerror=function(t){return e.error(t)}}).pipe(u.take(1))}e.openDB=p,e.onUpgradeEnded=s,e.setupLayers=f,e.dropDB=l,e.rxidb={openDB:p,dropDB:l}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r(0);e.rxifyRequest=function(t){var e=new n.Subject;return t.onerror=function(t){return e.error(t)},t.onsuccess=function(t){return e.next(t)},e},e.resultFromIDBEvent=function(t){return t.pipe(o.map(function(t){return t.target.result}))}},function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(4)),n(r(2)),n(r(3));var o=r(5);e.openDB=o.openDB,e.dropDB=o.dropDB}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicnhqcy9vcGVyYXRvcnNcIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJyeGpzXCIiLCJ3ZWJwYWNrOi8vLy4vc3JjL3J4aWRiLXN0b3JlLnRzIiwid2VicGFjazovLy8uL3NyYy9yeGlkYi11cGdyYWRlLnRzIiwid2VicGFjazovLy8uL3NyYy9yeGlkYi1kYi50cyIsIndlYnBhY2s6Ly8vLi9zcmMvcnhpZGItc3RhdGljLnRzIiwid2VicGFjazovLy8uL3NyYy9yeGlkYi11dGlscy50cyIsIndlYnBhY2s6Ly8vLi9yeGlkYi50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJ2YWx1ZSIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwicnhqcyIsIm9wZXJhdG9ycyIsInJ4anNfMSIsIm9wZXJhdG9yc18xIiwicnhpZGJfdXRpbHNfMSIsIlJ4SURCU3RvcmUiLCJfZGIiLCJfdGhpcyIsInRoaXMiLCJfdXBkYXRlJCIsIlN1YmplY3QiLCJ1cGRhdGUkIiwiYXNPYnNlcnZhYmxlIiwiZGF0YSQiLCJtZXJnZSIsImdldEFsbCIsInBpcGUiLCJzd2l0Y2hNYXAiLCJzaGFyZVJlcGxheSIsImNsZWFyIiwidHgiLCJtYXAiLCJvYmplY3RTdG9yZSIsInN0b3JlIiwicmVxIiwicnhpZnlSZXF1ZXN0IiwidGFwIiwiX3RyaWdnZXJVcGRhdGUiLCJtYXBUbyIsInVuZGVmaW5lZCIsImN1cnNvciIsIm1vZGUiLCJyYW5nZSIsImRpcmVjdGlvbiIsIm9wZW5DdXJzb3IiLCJyZXN1bHRGcm9tSURCRXZlbnQiLCJkZWxldGUiLCJrZXkiLCJyZXNldCIsImNvbGxlY3Rpb24iLCJ0YWtlIiwicHV0IiwidGFza3MiLCJmb3JrSm9pbiIsImN1cnNvciQiLCJkb25lJCIsImNvbnRpbnVlIiwibmV4dCIsImZpbHRlciIsImJ1ZmZlcldoZW4iLCJzZXQiLCJSeElEQlVwZ3JhZGVTdG9yZSIsIl9zdXBlciIsIl9uYW1lIiwiX3J4aWRiIiwiX3N0b3JlIiwiX19leHRlbmRzIiwiY3JlYXRlSW5kZXgiLCJrZXlwYXRoIiwicGFyYW1zIiwiZmlsbCIsImVudHJpZXMiLCJBcnJheSIsImZyb20iLCJmb3JFYWNoIiwiZW50cnkiLCJSeElEQlVwZ3JhZGUiLCJfZXZlbnQiLCJkYiIsInRhcmdldCIsInJlc3VsdCIsIm9sZFZlcnNpb24iLCJ2ZXJzaW9uIiwibmV3VmVyc2lvbiIsImNyZWF0ZSIsIm9wdGlvbnMiLCJjcmVhdGVPYmplY3RTdG9yZSIsImRlbGV0ZU9iamVjdFN0b3JlIiwiaGFzIiwib2JqZWN0U3RvcmVOYW1lcyIsImNvbnRhaW5zIiwicnhpZGJfc3RvcmVfMSIsIlJ4SURCIiwiaWRiIiwiX3N0b3JlQ2FjaGUiLCJjbG9zZSIsIm9mIiwidHJhbnNhY3Rpb24iLCJyeGlkYl9kYl8xIiwicnhpZGJfdXBncmFkZV8xIiwib3BlbkRCIiwiZGJOYW1lIiwiZGJWZXJzaW9uIiwic3RvcmVzIiwicnhJREIiLCJkYiQiLCJ1cGdyYWRlJCIsInJlcXVlc3QiLCJpbmRleGVkREIiLCJvcGVuIiwib25lcnJvciIsImUiLCJlcnJvciIsIm9uYmxvY2tlZCIsIm9uc3VjY2VzcyIsImV2ZW50IiwiY29tcGxldGUiLCJvbnVwZ3JhZGVuZWVkZWQiLCJvblVwZ3JhZGVFbmRlZCIsInN1YnNjcmliZSIsInJ4SURCVXBncmFkZSIsImxlbmd0aCIsImxheWVycyIsInNldHVwTGF5ZXJzIiwiTWFwIiwib2JzZXJ2YWJsZXMiLCJsYXllcnNfMSIsIl9fdmFsdWVzIiwibGF5ZXJzXzFfMSIsImRvbmUiLCJfYiIsIl9fcmVhZCIsImxheWVyVmVyc2lvbiIsImxheWVySW5zdGFsbGVyIiwiT2JzZXJ2YWJsZSIsInB1c2giLCJkcm9wREIiLCJvYnNlcnZlciIsImRlbGV0ZURhdGFiYXNlIiwicnhpZGIiLCJyZXF1ZXN0JCIsInNvdXJjZSIsIl9fZXhwb3J0IiwicnhpZGJfc3RhdGljXzEiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUNBSyxjQUFBLEVBQ0FDLFlBQUEsRUFDQUMsSUFBQU4sS0FNQVosRUFBQW1CLEVBQUEsU0FBQWpCLEdBQ0FZLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURrQixPQUFBLEtBSWpEcEIsRUFBQXFCLEVBQUEsU0FBQWxCLEdBQ0EsSUFBQVMsRUFBQVQsS0FBQW1CLFdBQ0EsV0FBMkIsT0FBQW5CLEVBQUEsU0FDM0IsV0FBaUMsT0FBQUEsR0FFakMsT0FEQUgsRUFBQVUsRUFBQUUsRUFBQSxJQUFBQSxHQUNBQSxHQUlBWixFQUFBYSxFQUFBLFNBQUFVLEVBQUFDLEdBQXNELE9BQUFWLE9BQUFXLFVBQUFDLGVBQUFuQixLQUFBZ0IsRUFBQUMsSUFHdER4QixFQUFBMkIsRUFBQSxHQUlBM0IsSUFBQTRCLEVBQUEsbUJDbkVBekIsRUFBQUQs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QXVCbkMsR0FDckIsT0FBT3pGLEVBQUEwSCxXQUFXbEQsT0FBTyxTQUFDcUQsR0FDeEIsSUFBSTlCLEVBQVVDLFVBQVU4QixlQUFlckMsR0FFdkNNLEVBQVFNLFVBQVksU0FBQ0YsR0FBTSxPQUFBMEIsRUFBU3pCLE1BQU1ELElBQzFDSixFQUFRTyxVQUFZLFdBQU0sT0FBQXVCLEVBQVNoRixVQUFLbEIsSUFDeENvRSxFQUFRRyxRQUFVLFNBQUNDLEdBQU0sT0FBQTBCLEVBQVN6QixNQUFNRCxNQUN2Q3JGLEtBQUtiLEVBQUFxQyxLQUFLLElBaEVmbkUsRUFBQXFILFNBZ0NBckgsRUFBQXVJLGlCQVFBdkksRUFBQTRJLGNBaUJBNUksRUFBQXlKLFNBVWF6SixFQUFBNEosT0FBVXZDLE9BQU1BLEVBQUVvQyxPQUFNQSxrRkMxRXJDLElBQUE1SCxFQUFBL0IsRUFBQSxHQUNBZ0MsRUFBQWhDLEVBQUEsR0FLQUUsRUFBQW9ELGFBQUEsU0FBNkJ3RSxHQUMzQixJQUFJaUMsRUFBeUIsSUFBSWhJLEVBQUFRLFFBS2pDLE9BSEF1RixFQUFRRyxRQUFZLFNBQUNDLEdBQVcsT0FBQTZCLEVBQVM1QixNQUFNRCxJQUMvQ0osRUFBUU8sVUFBWSxTQUFDSCxHQUFXLE9BQUE2QixFQUFTbkYsS0FBS3NELElBRXZDNkIsR0FNVDdKLEVBQUE4RCxtQkFBQSxTQUFtQ2dHLEdBQ2pDLE9BQU9BLEVBQU9uSCxLQUNaYixFQUFBa0IsSUFBSSxTQUFDZ0YsR0FBVyxPQUFBQSxFQUFFaEMsT0FBT0Msd0pDbkI3QjhELEVBQUFqSyxFQUFBLElBQ0FpSyxFQUFBakssRUFBQSxJQUNBaUssRUFBQWpLLEVBQUEsSUFDQSxJQUFBa0ssRUFBQWxLLEVBQUEsR0FBU0UsRUFBQXFILE9BQUEyQyxFQUFBM0MsT0FBUXJILEVBQUF5SixPQUFBTyxFQUFBUCIsImZpbGUiOiJyeGlkYi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNyk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHJ4anMvb3BlcmF0b3JzOyIsIm1vZHVsZS5leHBvcnRzID0gcnhqczsiLCJpbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0LCBtZXJnZSwgZm9ya0pvaW4gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IG1hcCwgc3dpdGNoTWFwLCBtYXBUbywgdGFwLCBmaWx0ZXIsIGJ1ZmZlcldoZW4sIHNoYXJlUmVwbGF5LCB0YWtlIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQgeyBSeElEQiB9IGZyb20gJy4vcnhpZGItZGInO1xuaW1wb3J0IHsgSVJ4SURCU3RvcmUgfSBmcm9tICcuL3J4aWRiLmludGVyZmFjZXMnO1xuaW1wb3J0IHsgcnhpZnlSZXF1ZXN0LCByZXN1bHRGcm9tSURCRXZlbnQgfSBmcm9tICcuL3J4aWRiLXV0aWxzJztcblxuZXhwb3J0IHR5cGUgUnhJREJDdXJzb3JSYW5nZSA9IHN0cmluZyB8IG51bWJlciB8IElEQktleVJhbmdlIHwgRGF0ZSB8IElEQkFycmF5S2V5IHwgdW5kZWZpbmVkO1xuXG5leHBvcnQgY2xhc3MgUnhJREJTdG9yZTxNb2RlbCA9IGFueT4gaW1wbGVtZW50cyBJUnhJREJTdG9yZSB7XG4gIHByaXZhdGUgX3VwZGF0ZSQ6IFN1YmplY3Q8dm9pZD4gPSBuZXcgU3ViamVjdCgpO1xuICBwdWJsaWMgdXBkYXRlJDogT2JzZXJ2YWJsZTxhbnk+ID0gdGhpcy5fdXBkYXRlJC5hc09ic2VydmFibGUoKTtcblxuICBwdWJsaWMgZGF0YSQ6IE9ic2VydmFibGU8TW9kZWxbXT4gPSBtZXJnZShcbiAgICB0aGlzLmdldEFsbCgpLFxuICAgIHRoaXMuX3VwZGF0ZSQucGlwZShzd2l0Y2hNYXAoKCkgPT4gdGhpcy5nZXRBbGwoKSkpXG4gICkucGlwZShcbiAgICBzaGFyZVJlcGxheSgxKVxuICApO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSBfZGI6IFJ4SURCXG4gICkge31cblxuICBwdWJsaWMgY2xlYXIoKTogT2JzZXJ2YWJsZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMudHgoJ3JlYWR3cml0ZScpLnBpcGUoXG4gICAgICBtYXAoKHR4KSA9PiB0eC5vYmplY3RTdG9yZSh0aGlzLm5hbWUpKSxcbiAgICAgIG1hcCgoc3RvcmUpID0+IHN0b3JlLmNsZWFyKCkpLFxuICAgICAgc3dpdGNoTWFwKHJlcSA9PiByeGlmeVJlcXVlc3QocmVxKSksXG4gICAgICB0YXAoKCkgPT4gdGhpcy5fdHJpZ2dlclVwZGF0ZSgpKSxcbiAgICAgIG1hcFRvKHVuZGVmaW5lZClcbiAgICApO1xuICB9XG5cbiAgcHVibGljIGN1cnNvcihcbiAgICBtb2RlOiAncmVhZG9ubHknfCdyZWFkd3JpdGUnID0gJ3JlYWRvbmx5JyxcbiAgICByYW5nZT86IFJ4SURCQ3Vyc29yUmFuZ2UsXG4gICAgZGlyZWN0aW9uPzogSURCQ3Vyc29yRGlyZWN0aW9uXG4gICk6IE9ic2VydmFibGU8SURCQ3Vyc29yV2l0aFZhbHVlPiB7XG4gICAgcmV0dXJuIHRoaXMudHgobW9kZSkucGlwZShcbiAgICAgIG1hcCh0eCA9PiB0eC5vYmplY3RTdG9yZSh0aGlzLm5hbWUpKSxcbiAgICAgIG1hcChzdG9yZSA9PiBzdG9yZS5vcGVuQ3Vyc29yKHJhbmdlLCBkaXJlY3Rpb24pKSxcbiAgICAgIHN3aXRjaE1hcChyZXEgPT4gcnhpZnlSZXF1ZXN0KHJlcSkpLFxuICAgICAgcmVzdWx0RnJvbUlEQkV2ZW50XG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBkZWxldGUoa2V5OiBJREJWYWxpZEtleSk6IE9ic2VydmFibGU8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLnR4KCdyZWFkd3JpdGUnKS5waXBlKFxuICAgICAgbWFwKCh0eCkgPT4gdHgub2JqZWN0U3RvcmUodGhpcy5uYW1lKSksXG4gICAgICBtYXAoKHN0b3JlKSA9PiBzdG9yZS5kZWxldGUoa2V5KSksXG4gICAgICBzd2l0Y2hNYXAocmVxID0+IHJ4aWZ5UmVxdWVzdChyZXEpKSxcbiAgICAgIHRhcCgoKSA9PiB0aGlzLl90cmlnZ2VyVXBkYXRlKCkpLFxuICAgICAgbWFwVG8odW5kZWZpbmVkKVxuICAgICk7XG4gIH1cblxuICBwdWJsaWMgcmVzZXQoY29sbGVjdGlvbjogYW55W10pOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLnR4KCdyZWFkd3JpdGUnKS5waXBlKFxuICAgICAgbWFwKCh0eCkgPT4gdHgub2JqZWN0U3RvcmUodGhpcy5uYW1lKSksXG4gICAgICBzd2l0Y2hNYXAoc3RvcmUgPT4gcnhpZnlSZXF1ZXN0KHN0b3JlLmNsZWFyKCkpLnBpcGUodGFrZSgxKSwgbWFwVG8oc3RvcmUpKSksXG4gICAgICBtYXAoc3RvcmUgPT4ge1xuICAgICAgICByZXR1cm4gY29sbGVjdGlvbi5tYXAodmFsdWUgPT4ge1xuICAgICAgICAgIHJldHVybiByeGlmeVJlcXVlc3Qoc3RvcmUucHV0KHZhbHVlKSkucGlwZShcbiAgICAgICAgICAgIHRha2UoMSksXG4gICAgICAgICAgICByZXN1bHRGcm9tSURCRXZlbnRcbiAgICAgICAgICApO1xuICAgICAgICB9KTtcbiAgICAgIH0pLFxuICAgICAgc3dpdGNoTWFwKCh0YXNrczogT2JzZXJ2YWJsZTxhbnk+W10pID0+IGZvcmtKb2luKHRhc2tzKSksXG4gICAgICB0YXAoKCkgPT4gdGhpcy5fdHJpZ2dlclVwZGF0ZSgpKVxuICAgICk7XG4gIH1cblxuICBwdWJsaWMgZ2V0KGtleTogSURCVmFsaWRLZXkpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLnR4KCkucGlwZShcbiAgICAgIG1hcCgodHgpID0+IHR4Lm9iamVjdFN0b3JlKHRoaXMubmFtZSkpLFxuICAgICAgbWFwKHN0b3JlID0+IHN0b3JlLmdldChrZXkpKSxcbiAgICAgIHN3aXRjaE1hcChyZXEgPT4gcnhpZnlSZXF1ZXN0KHJlcSkpLFxuICAgICAgcmVzdWx0RnJvbUlEQkV2ZW50XG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRBbGwoKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBsZXQgY3Vyc29yJCA9IHRoaXMuY3Vyc29yKCk7XG4gICAgbGV0IGRvbmUkICAgPSBuZXcgU3ViamVjdCgpO1xuXG4gICAgcmV0dXJuIGN1cnNvciQucGlwZShcbiAgICAgIHRhcChjdXJzb3IgPT4gISFjdXJzb3IgPyBjdXJzb3IuY29udGludWUoKSA6IGRvbmUkLm5leHQoKSksXG4gICAgICBmaWx0ZXIoY3Vyc29yID0+ICEhY3Vyc29yKSxcbiAgICAgIG1hcChjdXJzb3IgPT4gY3Vyc29yLnZhbHVlKSxcbiAgICAgIGJ1ZmZlcldoZW4oKCkgPT4gZG9uZSQpLFxuICAgICAgdGFrZSgxKVxuICAgICk7XG4gIH1cblxuICBwdWJsaWMgc2V0KHZhbHVlOiBhbnksIGtleT86IElEQlZhbGlkS2V5KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy50eCgncmVhZHdyaXRlJykucGlwZShcbiAgICAgIG1hcCgodHgpID0+IHR4Lm9iamVjdFN0b3JlKHRoaXMubmFtZSkpLFxuICAgICAgbWFwKHN0b3JlID0+IHN0b3JlLnB1dCh2YWx1ZSwga2V5KSksXG4gICAgICBzd2l0Y2hNYXAocmVxID0+IHJ4aWZ5UmVxdWVzdChyZXEpKSxcbiAgICAgIHRhcCgoKSA9PiB0aGlzLl90cmlnZ2VyVXBkYXRlKCkpLFxuICAgICAgcmVzdWx0RnJvbUlEQkV2ZW50XG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyB0eChtb2RlOiAncmVhZG9ubHknIHwgJ3JlYWR3cml0ZScgPSAncmVhZG9ubHknKTogT2JzZXJ2YWJsZTxJREJUcmFuc2FjdGlvbj4ge1xuICAgIHJldHVybiB0aGlzLl9kYi50eCh0aGlzLm5hbWUsIG1vZGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRyaWdnZXIgdXBkYXRlIHN0cmVhbVxuICAgKi9cbiAgcHJpdmF0ZSBfdHJpZ2dlclVwZGF0ZSgpIHtcbiAgICB0aGlzLl91cGRhdGUkLm5leHQoKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgUnhJREIgfSBmcm9tICcuL3J4aWRiLWRiJztcbmltcG9ydCB7IFJ4SURCU3RvcmUgfSBmcm9tICcuL3J4aWRiLXN0b3JlJztcbmltcG9ydCB7IElSeElEQlVwZ3JhZGUgfSBmcm9tICcuL3J4aWRiLmludGVyZmFjZXMnO1xuXG5leHBvcnQgY2xhc3MgUnhJREJVcGdyYWRlU3RvcmUgZXh0ZW5kcyBSeElEQlN0b3JlIHtcbiAgY29uc3RydWN0b3IoXG4gICAgX25hbWU6IHN0cmluZyxcbiAgICBfcnhpZGI6IFJ4SURCLFxuICAgIHByaXZhdGUgX3N0b3JlOiBJREJPYmplY3RTdG9yZVxuICApIHtcbiAgICBzdXBlcihfbmFtZSwgX3J4aWRiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgaW5kZXhcbiAgICovXG4gIHB1YmxpYyBjcmVhdGVJbmRleChuYW1lOiBzdHJpbmcsIGtleXBhdGg6IHN0cmluZywgcGFyYW1zPzogSURCSW5kZXhQYXJhbWV0ZXJzKTogSURCSW5kZXgge1xuICAgIHJldHVybiB0aGlzLl9zdG9yZS5jcmVhdGVJbmRleChuYW1lLCBrZXlwYXRoLCBwYXJhbXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEZpbGwgREIgd2l0aCBlbnRyaWVzXG4gICAqL1xuICBwdWJsaWMgZmlsbChlbnRyaWVzOiBJdGVyYWJsZTxhbnk+KTogdGhpcyB7XG4gICAgQXJyYXkuZnJvbShlbnRyaWVzKS5mb3JFYWNoKGVudHJ5ID0+IHRoaXMuX3N0b3JlLnB1dChlbnRyeSkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBSeElEQlVwZ3JhZGUgaW1wbGVtZW50cyBJUnhJREJVcGdyYWRlIHtcbiAgcHVibGljIHJlYWRvbmx5IGRiOiBJREJEYXRhYmFzZTtcbiAgcHVibGljIHJlYWRvbmx5IG9sZFZlcnNpb246IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IHZlcnNpb246IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvciAoXG4gICAgcHJpdmF0ZSBfcnhpZGI6IFJ4SURCLFxuICAgIF9ldmVudDogYW55XG4gICkge1xuICAgIHRoaXMuZGIgICAgICAgICA9IF9ldmVudC50YXJnZXQucmVzdWx0O1xuICAgIHRoaXMub2xkVmVyc2lvbiA9IF9ldmVudC5vbGRWZXJzaW9uO1xuICAgIHRoaXMudmVyc2lvbiAgICA9IF9ldmVudC5uZXdWZXJzaW9uO1xuICB9XG5cbiAgcHVibGljIGNyZWF0ZShuYW1lOiBzdHJpbmcsIG9wdGlvbnM/OiBJREJPYmplY3RTdG9yZVBhcmFtZXRlcnMpOiBSeElEQlVwZ3JhZGVTdG9yZSB7XG4gICAgbGV0IHN0b3JlID0gdGhpcy5kYi5jcmVhdGVPYmplY3RTdG9yZShuYW1lLCBvcHRpb25zKTtcbiAgICByZXR1cm4gbmV3IFJ4SURCVXBncmFkZVN0b3JlKG5hbWUsIHRoaXMuX3J4aWRiLCBzdG9yZSk7XG4gIH1cblxuICBwdWJsaWMgZGVsZXRlKG5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuZGIuZGVsZXRlT2JqZWN0U3RvcmUobmFtZSk7XG4gIH1cblxuICBwdWJsaWMgaGFzKG5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMobmFtZSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7IElSeElEQiB9IGZyb20gJy4vcnhpZGIuaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBSeElEQlN0b3JlIH0gZnJvbSAnLi9yeGlkYi1zdG9yZSc7XG5cbmV4cG9ydCBjbGFzcyBSeElEQiBpbXBsZW1lbnRzIElSeElEQiB7XG4gIHByaXZhdGUgX3N0b3JlQ2FjaGU6IHtba2V5OiBzdHJpbmddOiBSeElEQlN0b3JlfSA9IHt9O1xuXG4gIGNvbnN0cnVjdG9yIChcbiAgICBwdWJsaWMgcmVhZG9ubHkgaWRiOiBJREJEYXRhYmFzZVxuICApIHt9XG5cbiAgLyoqXG4gICAqIENsb3NlIGRiXG4gICAqL1xuICBwdWJsaWMgY2xvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5pZGIuY2xvc2UoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgc3RvcmVcbiAgICovXG4gIHB1YmxpYyBnZXQoa2V5OiBzdHJpbmcpOiBSeElEQlN0b3JlIHtcbiAgICBpZiAodGhpcy5fc3RvcmVDYWNoZVtrZXldKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3RvcmVDYWNoZVtrZXldO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLl9zdG9yZUNhY2hlW2tleV0gPSBuZXcgUnhJREJTdG9yZShrZXksIHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0cmVhbTogSURCVHJhbnNhY3Rpb25cbiAgICovXG4gIHB1YmxpYyB0eChzdG9yZTogc3RyaW5nIHwgc3RyaW5nW10sIG1vZGU6ICdyZWFkb25seScgfCAncmVhZHdyaXRlJyA9ICdyZWFkb25seScpOiBPYnNlcnZhYmxlPElEQlRyYW5zYWN0aW9uPiB7XG4gICAgcmV0dXJuIG9mKG51bGwpLnBpcGUoXG4gICAgICBtYXAoKCkgPT4gdGhpcy5pZGIudHJhbnNhY3Rpb24oc3RvcmUsIG1vZGUpKVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogT3BlbiBJREJUcmFuc2FjdGlvblxuICAgKi9cbiAgcHVibGljIHRyYW5zYWN0aW9uKHN0b3JlOiBzdHJpbmd8c3RyaW5nW10sIG1vZGU6ICdyZWFkb25seSd8J3JlYWR3cml0ZScgPSAncmVhZG9ubHknKTogSURCVHJhbnNhY3Rpb24ge1xuICAgIHJldHVybiB0aGlzLmlkYi50cmFuc2FjdGlvbihzdG9yZSwgbW9kZSk7XG4gIH1cbn1cbiIsImltcG9ydCB7IE9ic2VydmFibGUsIGZvcmtKb2luLCBTdWJqZWN0LCBvZiwgT2JzZXJ2ZXIgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHRha2UsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgUnhJREIgfSBmcm9tICcuL3J4aWRiLWRiJztcbmltcG9ydCB7IFJ4SURCTGF5ZXJzIH0gZnJvbSAnLi9yeGlkYi50eXBlcyc7XG5pbXBvcnQgeyBSeElEQlVwZ3JhZGUgfSBmcm9tICcuL3J4aWRiLXVwZ3JhZGUnO1xuXG5leHBvcnQgZnVuY3Rpb24gb3BlbkRCKGRiTmFtZTogc3RyaW5nLCBkYlZlcnNpb246IG51bWJlciwgc3RvcmVzPzogUnhJREJMYXllcnNbXSk6IE9ic2VydmFibGU8UnhJREI+IHtcbiAgbGV0IGRiJDogU3ViamVjdDxSeElEQj4gPSBuZXcgU3ViamVjdCgpO1xuICBsZXQgdXBncmFkZSQ6IFN1YmplY3Q8dm9pZD4gPSBuZXcgU3ViamVjdCgpO1xuICBsZXQgcmVxdWVzdDogSURCT3BlbkRCUmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKGRiTmFtZSwgZGJWZXJzaW9uKTtcbiAgbGV0IHJ4SURCOiBSeElEQjtcblxuICByZXF1ZXN0Lm9uZXJyb3IgICAgICAgICA9IChlOiBhbnkpID0+IGRiJC5lcnJvcihlKTtcbiAgcmVxdWVzdC5vbmJsb2NrZWQgICAgICAgPSAoZTogYW55KSA9PiBkYiQuZXJyb3IoZSk7XG4gIHJlcXVlc3Qub25zdWNjZXNzICAgICAgID0gKGV2ZW50OiBhbnkpID0+IHtcbiAgICByeElEQiA9IHJ4SURCIHx8IG5ldyBSeElEQihldmVudC50YXJnZXQucmVzdWx0KTtcbiAgICBkYiQubmV4dChyeElEQik7XG4gICAgZGIkLmNvbXBsZXRlKCk7XG5cbiAgICBpZiAoZGJWZXJzaW9uID09PSByeElEQi5pZGIudmVyc2lvbikge1xuICAgICAgdXBncmFkZSQubmV4dCgpO1xuICAgICAgdXBncmFkZSQuY29tcGxldGUoKTtcbiAgICB9XG4gIH07XG4gIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gKGV2ZW50OiBhbnkpID0+IHtcbiAgICByeElEQiA9IHJ4SURCIHx8IG5ldyBSeElEQihldmVudC50YXJnZXQucmVzdWx0KTtcbiAgICBvblVwZ3JhZGVFbmRlZChuZXcgUnhJREJVcGdyYWRlKHJ4SURCLCBldmVudCksIHN0b3Jlcykuc3Vic2NyaWJlKFxuICAgICAgKCkgPT4gdXBncmFkZSQubmV4dCgpLFxuICAgICAgKGUpID0+IHVwZ3JhZGUkLmVycm9yKGUpLFxuICAgICAgKCkgPT4gdXBncmFkZSQuY29tcGxldGUoKVxuICAgICk7XG4gIH07XG5cbiAgcmV0dXJuIGZvcmtKb2luKFtkYiQsIHVwZ3JhZGUkXSkucGlwZShcbiAgICBtYXAoKCkgPT4gcnhJREIpXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBvblVwZ3JhZGVFbmRlZChyeElEQlVwZ3JhZGU6IFJ4SURCVXBncmFkZSwgc3RvcmVzPzogUnhJREJMYXllcnNbXSk6IE9ic2VydmFibGU8YW55PiB7XG4gIGlmICghc3RvcmVzIHx8ICFzdG9yZXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIG9mKG51bGwpO1xuICB9XG5cbiAgcmV0dXJuIGZvcmtKb2luKHN0b3Jlcy5tYXAobGF5ZXJzID0+IHNldHVwTGF5ZXJzKHJ4SURCVXBncmFkZSwgbGF5ZXJzKSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBMYXllcnMocnhJREJVcGdyYWRlOiBSeElEQlVwZ3JhZGUsIGxheWVyczogUnhJREJMYXllcnMgPSBuZXcgTWFwKCkpOiBPYnNlcnZhYmxlPGFueT5bXSB7XG4gIGxldCB7IG9sZFZlcnNpb24gfSA9IHJ4SURCVXBncmFkZTtcbiAgbGV0IG9ic2VydmFibGVzOiBPYnNlcnZhYmxlPGFueT5bXSA9IFtvZih0cnVlKV07XG5cbiAgZm9yIChjb25zdCBbbGF5ZXJWZXJzaW9uLCBsYXllckluc3RhbGxlcl0gb2YgbGF5ZXJzKSB7XG4gICAgaWYgKG9sZFZlcnNpb24gPCBsYXllclZlcnNpb24pIHtcbiAgICAgIGxldCByZXN1bHQgPSBsYXllckluc3RhbGxlcihyeElEQlVwZ3JhZGUpO1xuXG4gICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgT2JzZXJ2YWJsZSkge1xuICAgICAgICBvYnNlcnZhYmxlcy5wdXNoKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG9ic2VydmFibGVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZHJvcERCKGRiTmFtZTogc3RyaW5nKTogT2JzZXJ2YWJsZTx2b2lkPiB7XG4gIHJldHVybiBPYnNlcnZhYmxlLmNyZWF0ZSgob2JzZXJ2ZXI6IE9ic2VydmVyPHZvaWQ+KSA9PiB7XG4gICAgbGV0IHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoZGJOYW1lKTtcblxuICAgIHJlcXVlc3Qub25ibG9ja2VkID0gKGUpID0+IG9ic2VydmVyLmVycm9yKGUpO1xuICAgIHJlcXVlc3Qub25zdWNjZXNzID0gKCkgPT4gb2JzZXJ2ZXIubmV4dCh1bmRlZmluZWQpO1xuICAgIHJlcXVlc3Qub25lcnJvciA9IChlKSA9PiBvYnNlcnZlci5lcnJvcihlKTtcbiAgfSkucGlwZSh0YWtlKDEpKTtcbn1cblxuZXhwb3J0IGNvbnN0IHJ4aWRiID0geyBvcGVuREIsIGRyb3BEQiB9O1xuIiwiaW1wb3J0IHsgU3ViamVjdCwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG4vKipcbiAqIFJlc29sdmUgcmVxdWVzdCBhcyBhbiBPYnNlcnZhYmxlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByeGlmeVJlcXVlc3QocmVxdWVzdDogSURCUmVxdWVzdCk6IE9ic2VydmFibGU8YW55PiB7XG4gIGxldCByZXF1ZXN0JDogU3ViamVjdDxhbnk+ID0gbmV3IFN1YmplY3QoKTtcblxuICByZXF1ZXN0Lm9uZXJyb3IgICA9IChlOiBhbnkpID0+IHJlcXVlc3QkLmVycm9yKGUpO1xuICByZXF1ZXN0Lm9uc3VjY2VzcyA9IChlOiBhbnkpID0+IHJlcXVlc3QkLm5leHQoZSk7XG5cbiAgcmV0dXJuIHJlcXVlc3QkO1xufVxuXG4vKipcbiAqIFBpcGUgb3BlcmF0b3IgZm9yIGV4dHJhY3RpbmcgcmVzdWx0IGZyb20gaWRiIGV2ZW50XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXN1bHRGcm9tSURCRXZlbnQoc291cmNlOiBPYnNlcnZhYmxlPGFueT4pIHtcbiAgcmV0dXJuIHNvdXJjZS5waXBlKFxuICAgIG1hcCgoZTogYW55KSA9PiBlLnRhcmdldC5yZXN1bHQpXG4gICk7XG59XG4iLCJleHBvcnQgKiBmcm9tICcuL3NyYy9yeGlkYi50eXBlcyc7XG5leHBvcnQgKiBmcm9tICcuL3NyYy9yeGlkYi1kYic7XG5leHBvcnQgKiBmcm9tICcuL3NyYy9yeGlkYi1zdG9yZSc7XG5leHBvcnQgKiBmcm9tICcuL3NyYy9yeGlkYi11cGdyYWRlJztcbmV4cG9ydCB7IG9wZW5EQiwgZHJvcERCIH0gZnJvbSAnLi9zcmMvcnhpZGItc3RhdGljJztcbiJdLCJzb3VyY2VSb290IjoiIn0=